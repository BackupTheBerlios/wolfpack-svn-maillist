<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Wolfpack-svn] r6873 - in trunk/WPGM: . Release build src
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/wolfpack-svn/2009-March/index.html" >
   <LINK REL="made" HREF="mailto:wolfpack-svn%40lists.berlios.de?Subject=Re%3A%20%5BWolfpack-svn%5D%20r6873%20-%20in%20trunk/WPGM%3A%20.%20Release%20build%20src&In-Reply-To=%3C200903210441.n2L4fR00022199%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000075.html">
   <LINK REL="Next"  HREF="000077.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Wolfpack-svn] r6873 - in trunk/WPGM: . Release build src</H1>
    <B>lastkiller at mail.berlios.de</B> 
    <A HREF="mailto:wolfpack-svn%40lists.berlios.de?Subject=Re%3A%20%5BWolfpack-svn%5D%20r6873%20-%20in%20trunk/WPGM%3A%20.%20Release%20build%20src&In-Reply-To=%3C200903210441.n2L4fR00022199%40sheep.berlios.de%3E"
       TITLE="[Wolfpack-svn] r6873 - in trunk/WPGM: . Release build src">lastkiller at mail.berlios.de
       </A><BR>
    <I>Sat Mar 21 05:41:27 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000075.html">[Wolfpack-svn] r6872 - in trunk/server: build release/definitions
</A></li>
        <LI>Next message: <A HREF="000077.html">[Wolfpack-svn] r6874 - in trunk/server/src: . ai
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#76">[ date ]</a>
              <a href="thread.html#76">[ thread ]</a>
              <a href="subject.html#76">[ subject ]</a>
              <a href="author.html#76">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: lastkiller
Date: 2009-03-21 05:40:17 +0100 (Sat, 21 Mar 2009)
New Revision: 6873

Added:
   trunk/WPGM/build/stop16.bmp
   trunk/WPGM/src/RegionEditR.dfm
   trunk/WPGM/src/RegionEditR.pas
   trunk/WPGM/src/RegionEditS.dfm
   trunk/WPGM/src/RegionEditS.pas
Modified:
   trunk/WPGM/COMPILING.TXT
   trunk/WPGM/Release/WPGM.exe
   trunk/WPGM/Release/categories.db
   trunk/WPGM/Release/config.ini
   trunk/WPGM/build/WPGM.dpr
   trunk/WPGM/build/WPGM.dproj
   trunk/WPGM/build/WPGM.dproj.local
   trunk/WPGM/build/WPGM.identcache
   trunk/WPGM/build/WPGM.res
   trunk/WPGM/changelog.txt
   trunk/WPGM/src/Main.dfm
   trunk/WPGM/src/RegionWizard3Spawn.dfm
   trunk/WPGM/src/RegionWizard4Spawn.pas
   trunk/WPGM/src/Spawnregions.dfm
   trunk/WPGM/src/Spawnregions.pas
Log:
Little changes on WPGM:

- Minor changes on regions editor, but it is not finished yet

Modified: trunk/WPGM/COMPILING.TXT
===================================================================
--- trunk/WPGM/COMPILING.TXT	2009-03-17 19:04:31 UTC (rev 6872)
+++ trunk/WPGM/COMPILING.TXT	2009-03-21 04:40:17 UTC (rev 6873)
@@ -4,5 +4,5 @@
 Graphics32 Components - <A HREF="http://graphics32.org">http://graphics32.org</A>
 VirtualTreeview - <A HREF="http://www.soft-gems.net/">http://www.soft-gems.net/</A>
 
-The two required compents are with teh package, Graphics32 was modified to work with Delphi 2007 and
+The two required compents are with the package, Graphics32 was modified to work with Delphi 2007 and
 VirtualTreeview the instaler is provider.
\ No newline at end of file

Modified: trunk/WPGM/Release/WPGM.exe
===================================================================
(Binary files differ)

Modified: trunk/WPGM/Release/categories.db
===================================================================
(Binary files differ)

Modified: trunk/WPGM/Release/config.ini
===================================================================
--- trunk/WPGM/Release/config.ini	2009-03-17 19:04:31 UTC (rev 6872)
+++ trunk/WPGM/Release/config.ini	2009-03-21 04:40:17 UTC (rev 6873)
@@ -3,15 +3,15 @@
 SpawnMin=1
 SpawnMax=1
 Command Prefix='
-Window Position X=324
-Window Position Y=396
+Window Position X=644
+Window Position Y=424
 Window Width=632
 Window Height=233
-Current Page=7
+Current Page=0
 EventCount=0
-Map0Modify=31/1/2008 22:12:48
-Statics0Modify=31/1/2008 22:24:12
-Staidx0Modify=31/1/2008 22:24:12
+Map0Modify=25/08/2008 22:16:48
+Statics0Modify=25/08/2008 22:16:48
+Staidx0Modify=25/08/2008 22:16:48
 Map4Modify=16/5/2007 02:41:00
 Statics4Modify=7/5/2007 11:15:08
 Staidx4Modify=7/5/2007 11:14:56

Modified: trunk/WPGM/build/WPGM.dpr
===================================================================
--- trunk/WPGM/build/WPGM.dpr	2009-03-17 19:04:31 UTC (rev 6872)
+++ trunk/WPGM/build/WPGM.dpr	2009-03-21 04:40:17 UTC (rev 6873)
@@ -27,7 +27,9 @@
   RegionWizard4Region in '..\src\RegionWizard4Region.pas' {frmRergionW4R},
   RegionWizard2Spawn in '..\src\RegionWizard2Spawn.pas' {frmRegionW2S},
   RegionWizard3Spawn in '..\src\RegionWizard3Spawn.pas' {FrmRegionW3S},
-  RegionWizard4Spawn in '..\src\RegionWizard4Spawn.pas' {FrmRegionW4S};
+  RegionWizard4Spawn in '..\src\RegionWizard4Spawn.pas' {FrmRegionW4S},
+  RegionEditR in '..\src\RegionEditR.pas' {FrmRegionEdit},
+  RegionEditS in '..\src\RegionEditS.pas' {FrmRegionEditS};
 
 {$R *.RES}
 
@@ -47,5 +49,7 @@
   Application.CreateForm(TfrmRegionW2S, frmRegionW2S);
   Application.CreateForm(TFrmRegionW3S, FrmRegionW3S);
   Application.CreateForm(TFrmRegionW4S, FrmRegionW4S);
+  Application.CreateForm(TFrmRegionEdit, FrmRegionEdit);
+  Application.CreateForm(TFrmRegionEditS, FrmRegionEditS);
   Application.Run;
 end.

Modified: trunk/WPGM/build/WPGM.dproj
===================================================================
--- trunk/WPGM/build/WPGM.dproj	2009-03-17 19:04:31 UTC (rev 6872)
+++ trunk/WPGM/build/WPGM.dproj	2009-03-21 04:40:17 UTC (rev 6873)
@@ -42,7 +42,7 @@
     &lt;Borland.Personality&gt;Delphi.Personality&lt;/Borland.Personality&gt;
     &lt;Borland.ProjectType&gt;VCLApplication&lt;/Borland.ProjectType&gt;
     &lt;BorlandProject&gt;
-&lt;BorlandProject&gt;&lt;Delphi.Personality&gt;&lt;Parameters&gt;&lt;Parameters Name=&quot;UseLauncher&quot;&gt;False&lt;/Parameters&gt;&lt;Parameters Name=&quot;LoadAllSymbols&quot;&gt;True&lt;/Parameters&gt;&lt;Parameters Name=&quot;LoadUnspecifiedSymbols&quot;&gt;False&lt;/Parameters&gt;&lt;/Parameters&gt;&lt;VersionInfo&gt;&lt;VersionInfo Name=&quot;IncludeVerInfo&quot;&gt;True&lt;/VersionInfo&gt;&lt;VersionInfo Name=&quot;AutoIncBuild&quot;&gt;True&lt;/VersionInfo&gt;&lt;VersionInfo Name=&quot;MajorVer&quot;&gt;1&lt;/VersionInfo&gt;&lt;VersionInfo Name=&quot;MinorVer&quot;&gt;0&lt;/VersionInfo&gt;&lt;VersionInfo Name=&quot;Release&quot;&gt;2&lt;/VersionInfo&gt;&lt;VersionInfo Name=&quot;Build&quot;&gt;1&lt;/VersionInfo&gt;&lt;VersionInfo Name=&quot;Debug&quot;&gt;False&lt;/VersionInfo&gt;&lt;VersionInfo Name=&quot;PreRelease&quot;&gt;False&lt;/VersionInfo&gt;&lt;VersionInfo Name=&quot;Special&quot;&gt;False&lt;/VersionInfo&gt;&lt;VersionInfo Name=&quot;Private&quot;&gt;False&lt;/VersionInfo&gt;&lt;VersionInfo Name=&quot;DLL&quot;&gt;False&lt;/VersionInfo&gt;&lt;VersionInfo Name=&quot;Locale&quot;&gt;1031&lt;/VersionInfo&gt;&lt;VersionInfo Name=&quot;CodePage&quot;&gt;1252&lt;/VersionInfo&gt;&lt;/VersionInfo&gt;&lt;VersionInfoKeys&gt;&lt;VersionInfoKeys Name=&quot;CompanyName&quot;&gt;&lt;/VersionInfoKeys&gt;&lt;VersionInfoKeys Name=&quot;FileDescription&quot;&gt;&lt;/VersionInfoKeys&gt;&lt;VersionInf!
 oKeys Name=&quot;FileVersion&quot;&gt;1.0.2.1&lt;/VersionInfoKeys&gt;&lt;VersionInfoKeys Name=&quot;InternalName&quot;&gt;&lt;/VersionInfoKeys&gt;&lt;VersionInfoKeys Name=&quot;LegalCopyright&quot;&gt;&lt;/VersionInfoKeys&gt;&lt;VersionInfoKeys Name=&quot;LegalTrademarks&quot;&gt;&lt;/VersionInfoKeys&gt;&lt;VersionInfoKeys Name=&quot;OriginalFilename&quot;&gt;&lt;/VersionInfoKeys&gt;&lt;VersionInfoKeys Name=&quot;ProductName&quot;&gt;&lt;/VersionInfoKeys&gt;&lt;VersionInfoKeys Name=&quot;ProductVersion&quot;&gt;1.0.0.0&lt;/VersionInfoKeys&gt;&lt;VersionInfoKeys Name=&quot;Comments&quot;&gt;&lt;/VersionInfoKeys&gt;&lt;/VersionInfoKeys&gt;&lt;Source&gt;&lt;Source Name=&quot;MainSource&quot;&gt;WPGM.dpr&lt;/Source&gt;&lt;/Source&gt;&lt;/Delphi.Personality&gt;&lt;/BorlandProject&gt;&lt;/BorlandProject&gt;
+&lt;BorlandProject&gt;&lt;Delphi.Personality&gt;&lt;Parameters&gt;&lt;Parameters Name=&quot;UseLauncher&quot;&gt;False&lt;/Parameters&gt;&lt;Parameters Name=&quot;LoadAllSymbols&quot;&gt;True&lt;/Parameters&gt;&lt;Parameters Name=&quot;LoadUnspecifiedSymbols&quot;&gt;False&lt;/Parameters&gt;&lt;/Parameters&gt;&lt;VersionInfo&gt;&lt;VersionInfo Name=&quot;IncludeVerInfo&quot;&gt;True&lt;/VersionInfo&gt;&lt;VersionInfo Name=&quot;AutoIncBuild&quot;&gt;True&lt;/VersionInfo&gt;&lt;VersionInfo Name=&quot;MajorVer&quot;&gt;1&lt;/VersionInfo&gt;&lt;VersionInfo Name=&quot;MinorVer&quot;&gt;0&lt;/VersionInfo&gt;&lt;VersionInfo Name=&quot;Release&quot;&gt;2&lt;/VersionInfo&gt;&lt;VersionInfo Name=&quot;Build&quot;&gt;2&lt;/VersionInfo&gt;&lt;VersionInfo Name=&quot;Debug&quot;&gt;False&lt;/VersionInfo&gt;&lt;VersionInfo Name=&quot;PreRelease&quot;&gt;False&lt;/VersionInfo&gt;&lt;VersionInfo Name=&quot;Special&quot;&gt;False&lt;/VersionInfo&gt;&lt;VersionInfo Name=&quot;Private&quot;&gt;False&lt;/VersionInfo&gt;&lt;VersionInfo Name=&quot;DLL&quot;&gt;False&lt;/VersionInfo&gt;&lt;VersionInfo Name=&quot;Locale&quot;&gt;1031&lt;/VersionInfo&gt;&lt;VersionInfo Name=&quot;CodePage&quot;&gt;1252&lt;/VersionInfo&gt;&lt;/VersionInfo&gt;&lt;VersionInfoKeys&gt;&lt;VersionInfoKeys Name=&quot;CompanyName&quot;&gt;&lt;/VersionInfoKeys&gt;&lt;VersionInfoKeys Name=&quot;FileDescription&quot;&gt;&lt;/VersionInfoKeys&gt;&lt;VersionInf!
 oKeys Name=&quot;FileVersion&quot;&gt;1.0.2.2&lt;/VersionInfoKeys&gt;&lt;VersionInfoKeys Name=&quot;InternalName&quot;&gt;&lt;/VersionInfoKeys&gt;&lt;VersionInfoKeys Name=&quot;LegalCopyright&quot;&gt;&lt;/VersionInfoKeys&gt;&lt;VersionInfoKeys Name=&quot;LegalTrademarks&quot;&gt;&lt;/VersionInfoKeys&gt;&lt;VersionInfoKeys Name=&quot;OriginalFilename&quot;&gt;&lt;/VersionInfoKeys&gt;&lt;VersionInfoKeys Name=&quot;ProductName&quot;&gt;&lt;/VersionInfoKeys&gt;&lt;VersionInfoKeys Name=&quot;ProductVersion&quot;&gt;1.0.0.0&lt;/VersionInfoKeys&gt;&lt;VersionInfoKeys Name=&quot;Comments&quot;&gt;&lt;/VersionInfoKeys&gt;&lt;/VersionInfoKeys&gt;&lt;Source&gt;&lt;Source Name=&quot;MainSource&quot;&gt;WPGM.dpr&lt;/Source&gt;&lt;/Source&gt;&lt;/Delphi.Personality&gt;&lt;/BorlandProject&gt;&lt;/BorlandProject&gt;
   &lt;/ProjectExtensions&gt;
   &lt;Import Project=&quot;$(MSBuildBinPath)\Borland.Delphi.Targets&quot; /&gt;
   &lt;ItemGroup&gt;
@@ -61,6 +61,12 @@
     &lt;DCCReference Include=&quot;..\src\Progress.pas&quot;&gt;
       &lt;Form&gt;frmProgress&lt;/Form&gt;
     &lt;/DCCReference&gt;
+    &lt;DCCReference Include=&quot;..\src\RegionEditR.pas&quot;&gt;
+      &lt;Form&gt;FrmRegionEdit&lt;/Form&gt;
+    &lt;/DCCReference&gt;
+    &lt;DCCReference Include=&quot;..\src\RegionEditS.pas&quot;&gt;
+      &lt;Form&gt;FrmRegionEditS&lt;/Form&gt;
+    &lt;/DCCReference&gt;
     &lt;DCCReference Include=&quot;..\src\RegionWizard.pas&quot;&gt;
       &lt;Form&gt;frmRegionW1&lt;/Form&gt;
     &lt;/DCCReference&gt;

Modified: trunk/WPGM/build/WPGM.dproj.local
===================================================================
--- trunk/WPGM/build/WPGM.dproj.local	2009-03-17 19:04:31 UTC (rev 6872)
+++ trunk/WPGM/build/WPGM.dproj.local	2009-03-21 04:40:17 UTC (rev 6873)
@@ -45,5 +45,9 @@
     &lt;Transaction&gt;2008/02/24 17:28:36.281.dfm,E:\RGS\UOEmu\wpdev\WPGM\build\Unit1.dfm=E:\RGS\UOEmu\wpdev\WPGM\src\RegionWizard3Spawn.dfm&lt;/Transaction&gt;
     &lt;Transaction&gt;2008/02/24 17:56:39.390.pas,E:\RGS\UOEmu\wpdev\WPGM\build\Unit1.pas=E:\RGS\UOEmu\wpdev\WPGM\src\RegionWizard4Spawn.pas&lt;/Transaction&gt;
     &lt;Transaction&gt;2008/02/24 17:56:39.390.dfm,E:\RGS\UOEmu\wpdev\WPGM\build\Unit1.dfm=E:\RGS\UOEmu\wpdev\WPGM\src\RegionWizard4Spawn.dfm&lt;/Transaction&gt;
+    &lt;Transaction&gt;2008/02/28 20:38:57.796.pas,E:\RGS\UOEmu\wpdev\WPGM\build\Unit1.pas=E:\RGS\UOEmu\wpdev\WPGM\src\RegionEditR.pas&lt;/Transaction&gt;
+    &lt;Transaction&gt;2008/02/28 20:38:57.812.dfm,E:\RGS\UOEmu\wpdev\WPGM\build\Unit1.dfm=E:\RGS\UOEmu\wpdev\WPGM\src\RegionEditR.dfm&lt;/Transaction&gt;
+    &lt;Transaction&gt;2008/02/29 19:56:05.718.pas,E:\RGS\UOEmu\wpdev\WPGM\build\Unit1.pas=E:\RGS\UOEmu\wpdev\WPGM\src\RegionEditS.pas&lt;/Transaction&gt;
+    &lt;Transaction&gt;2008/02/29 19:56:05.734.dfm,E:\RGS\UOEmu\wpdev\WPGM\build\Unit1.dfm=E:\RGS\UOEmu\wpdev\WPGM\src\RegionEditS.dfm&lt;/Transaction&gt;
   &lt;/Transactions&gt;
 &lt;/BorlandProject&gt;

Modified: trunk/WPGM/build/WPGM.identcache
===================================================================
(Binary files differ)

Modified: trunk/WPGM/build/WPGM.res
===================================================================
(Binary files differ)

Added: trunk/WPGM/build/stop16.bmp
===================================================================
(Binary files differ)


Property changes on: trunk/WPGM/build/stop16.bmp
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Modified: trunk/WPGM/changelog.txt
===================================================================
--- trunk/WPGM/changelog.txt	2009-03-17 19:04:31 UTC (rev 6872)
+++ trunk/WPGM/changelog.txt	2009-03-21 04:40:17 UTC (rev 6873)
@@ -1,3 +1,6 @@
+21.03.2009 1.0.1.x:
+	- Minor changes on regions editor, but it is incomplete yet
+
 26.02.2008 1.0.1.x:
 	- Added a wizard for region and spawnregion creation. Use &quot;New Region&quot; button
 	- Added &quot;Export Region&quot; Button which copies a complete region/spawnregion to clipboard

Modified: trunk/WPGM/src/Main.dfm
===================================================================
--- trunk/WPGM/src/Main.dfm	2009-03-17 19:04:31 UTC (rev 6872)
+++ trunk/WPGM/src/Main.dfm	2009-03-21 04:40:17 UTC (rev 6873)
@@ -23,13 +23,17 @@
     Top = 21
     Width = 604
     Height = 163
-    ActivePage = TabSheet1
+    ActivePage = tsSettings
     Align = alClient
     RaggedRight = True
     TabOrder = 0
     object tsCommands: TTabSheet
       Caption = 'Commands'
       ImageIndex = 3
+      ExplicitLeft = 0
+      ExplicitTop = 0
+      ExplicitWidth = 0
+      ExplicitHeight = 0
       object GroupBox1: TGroupBox
         Left = 8
         Top = 8
@@ -180,6 +184,10 @@
     object tsItems: TTabSheet
       Caption = 'Items'
       ImageIndex = -1
+      ExplicitLeft = 0
+      ExplicitTop = 0
+      ExplicitWidth = 0
+      ExplicitHeight = 0
       DesignSize = (
         596
         135)
@@ -350,6 +358,10 @@
     object tsItemManip: TTabSheet
       Caption = 'Item Manipulation'
       ImageIndex = 4
+      ExplicitLeft = 0
+      ExplicitTop = 0
+      ExplicitWidth = 0
+      ExplicitHeight = 0
       object GroupBox3: TGroupBox
         Left = 8
         Top = 8
@@ -520,7 +532,7 @@
           Top = 24
           Width = 153
           Height = 21
-          ItemHeight = 13
+          ItemHeight = 0
           TabOrder = 0
           OnChange = cbItemPropertyChange
           Items.Strings = (
@@ -578,6 +590,10 @@
     object tsNpcs: TTabSheet
       Caption = 'NPCs'
       ImageIndex = 6
+      ExplicitLeft = 0
+      ExplicitTop = 0
+      ExplicitWidth = 0
+      ExplicitHeight = 0
       DesignSize = (
         596
         135)
@@ -764,6 +780,10 @@
     object TabSheet1: TTabSheet
       Caption = 'Multis'
       ImageIndex = 7
+      ExplicitLeft = 0
+      ExplicitTop = 0
+      ExplicitWidth = 0
+      ExplicitHeight = 0
       DesignSize = (
         596
         135)
@@ -847,6 +867,10 @@
     object tsTags: TTabSheet
       Caption = 'Object Manipulation'
       ImageIndex = 5
+      ExplicitLeft = 0
+      ExplicitTop = 0
+      ExplicitWidth = 0
+      ExplicitHeight = 0
       object GroupBox6: TGroupBox
         Left = 8
         Top = 8
@@ -922,7 +946,7 @@
           Height = 21
           Hint = 'The type of the tag value.'
           Style = csDropDownList
-          ItemHeight = 13
+          ItemHeight = 0
           ItemIndex = 0
           TabOrder = 5
           Text = 'String'
@@ -1044,7 +1068,7 @@
           Top = 24
           Width = 121
           Height = 21
-          ItemHeight = 13
+          ItemHeight = 0
           TabOrder = 0
           OnChange = eEventNameChange
         end
@@ -1069,6 +1093,10 @@
     object TravelMap: TTabSheet
       Caption = 'Travel'
       ImageIndex = 2
+      ExplicitLeft = 0
+      ExplicitTop = 0
+      ExplicitWidth = 0
+      ExplicitHeight = 0
       DesignSize = (
         596
         135)
@@ -1288,6 +1316,10 @@
     object TabSheet2: TTabSheet
       Caption = 'Build'
       ImageIndex = 8
+      ExplicitLeft = 0
+      ExplicitTop = 0
+      ExplicitWidth = 0
+      ExplicitHeight = 0
       DesignSize = (
         596
         135)
@@ -1317,7 +1349,7 @@
           Top = 16
           Width = 58
           Height = 21
-          ItemHeight = 13
+          ItemHeight = 0
           TabOrder = 0
           Text = '0'
           Items.Strings = (
@@ -1371,6 +1403,10 @@
       Caption = 'Custom'
       ImageIndex = 9
       OnResize = tsCustomResize
+      ExplicitLeft = 0
+      ExplicitTop = 0
+      ExplicitWidth = 0
+      ExplicitHeight = 0
     end
   end
   object TbQuick: TToolBar

Added: trunk/WPGM/src/RegionEditR.dfm
===================================================================
--- trunk/WPGM/src/RegionEditR.dfm	2009-03-17 19:04:31 UTC (rev 6872)
+++ trunk/WPGM/src/RegionEditR.dfm	2009-03-21 04:40:17 UTC (rev 6873)
@@ -0,0 +1,227 @@
+object FrmRegionEdit: TFrmRegionEdit
+  Left = 353
+  Top = 124
+  Caption = 'Region - Edit'
+  ClientHeight = 609
+  ClientWidth = 441
+  Color = clBtnFace
+  Font.Charset = DEFAULT_CHARSET
+  Font.Color = clWindowText
+  Font.Height = -11
+  Font.Name = 'Tahoma'
+  Font.Style = []
+  FormStyle = fsStayOnTop
+  OldCreateOrder = False
+  Position = poDesktopCenter
+  PixelsPerInch = 96
+  TextHeight = 13
+  object Label1: TLabel
+    Left = 16
+    Top = 41
+    Width = 67
+    Height = 13
+    Caption = 'Region Name:'
+  end
+  object Label5: TLabel
+    Left = 16
+    Top = 364
+    Width = 71
+    Height = 13
+    Caption = 'Guard Owner :'
+  end
+  object Label6: TLabel
+    Left = 220
+    Top = 364
+    Width = 38
+    Height = 13
+    Caption = 'MidiList:'
+  end
+  object Label7: TLabel
+    Left = 16
+    Top = 416
+    Width = 64
+    Height = 13
+    Caption = 'Rain Chance:'
+  end
+  object Label8: TLabel
+    Left = 223
+    Top = 416
+    Width = 69
+    Height = 13
+    Caption = 'Snow Chance:'
+  end
+  object Label9: TLabel
+    Left = 16
+    Top = 471
+    Width = 40
+    Height = 13
+    Caption = 'resores:'
+  end
+  object ERegionName: TEdit
+    Left = 89
+    Top = 38
+    Width = 336
+    Height = 21
+    TabOrder = 0
+  end
+  object Eguardowner: TEdit
+    Left = 16
+    Top = 383
+    Width = 181
+    Height = 21
+    TabOrder = 1
+  end
+  object Emidilist: TEdit
+    Left = 220
+    Top = 383
+    Width = 205
+    Height = 21
+    TabOrder = 2
+  end
+  object Erainchancemin: TEdit
+    Left = 35
+    Top = 435
+    Width = 58
+    Height = 21
+    TabOrder = 3
+  end
+  object ESnowChancemin: TEdit
+    Left = 252
+    Top = 435
+    Width = 58
+    Height = 21
+    TabOrder = 4
+  end
+  object EResores: TEdit
+    Left = 16
+    Top = 490
+    Width = 409
+    Height = 21
+    TabOrder = 5
+  end
+  object Erainchancemax: TEdit
+    Left = 139
+    Top = 435
+    Width = 58
+    Height = 21
+    TabOrder = 6
+  end
+  object ESnowChancemax: TEdit
+    Left = 367
+    Top = 435
+    Width = 58
+    Height = 21
+    TabOrder = 7
+  end
+  object GroupBox1: TGroupBox
+    Left = 16
+    Top = 76
+    Width = 409
+    Height = 269
+    Caption = 'Regions Flags'
+    TabOrder = 8
+    object Label3: TLabel
+      Left = 24
+      Top = 25
+      Width = 73
+      Height = 13
+      Caption = 'Selected Flags:'
+    end
+    object Label4: TLabel
+      Left = 236
+      Top = 25
+      Width = 67
+      Height = 13
+      Caption = 'Avaible Flags:'
+    end
+    object LBSelected: TListBox
+      Left = 24
+      Top = 44
+      Width = 137
+      Height = 209
+      ItemHeight = 13
+      TabOrder = 0
+    end
+    object LBAvaible: TListBox
+      Left = 236
+      Top = 44
+      Width = 137
+      Height = 209
+      ItemHeight = 13
+      Items.Strings = (
+        'antimagic'
+        'cave'
+        'escortregion'
+        'guarded'
+        'instalogout'
+        'noagressivemagic'
+        'nocriminalcombat'
+        'nodecay'
+        'noentermessage'
+        'nogate'
+        'noguardmessage'
+        'nohousing'
+        'nokillcount'
+        'nomark'
+        'nomusic'
+        'norecallin'
+        'norecallout'
+        'noteleport'
+        'recallshield'
+        'safe')
+      Sorted = True
+      TabOrder = 1
+    end
+    object Insert: TButton
+      Left = 184
+      Top = 108
+      Width = 25
+      Height = 25
+      Caption = '&lt;'
+      TabOrder = 2
+      OnClick = InsertClick
+    end
+    object Remove: TButton
+      Left = 184
+      Top = 152
+      Width = 25
+      Height = 25
+      Caption = '&gt;'
+      TabOrder = 3
+      OnClick = RemoveClick
+    end
+  end
+  object GroupBox2: TGroupBox
+    Left = 64
+    Top = 536
+    Width = 321
+    Height = 57
+    TabOrder = 9
+    object BitBtn1: TBitBtn
+      Left = 46
+      Top = 20
+      Width = 75
+      Height = 25
+      Caption = 'OK'
+      TabOrder = 0
+      OnClick = BitBtn1Click
+    end
+    object BitBtn2: TBitBtn
+      Left = 202
+      Top = 20
+      Width = 75
+      Height = 25
+      Caption = 'Cancel'
+      TabOrder = 1
+      OnClick = BitBtn2Click
+    end
+  end
+  object Panel1: TPanel
+    Left = 12
+    Top = 5
+    Width = 413
+    Height = 27
+    Caption = 'Edit your Region '
+    TabOrder = 10
+  end
+end

Added: trunk/WPGM/src/RegionEditR.pas
===================================================================
--- trunk/WPGM/src/RegionEditR.pas	2009-03-17 19:04:31 UTC (rev 6872)
+++ trunk/WPGM/src/RegionEditR.pas	2009-03-21 04:40:17 UTC (rev 6873)
@@ -0,0 +1,113 @@
+unit RegionEditR;
+
+interface
+
+uses
+  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
+  Dialogs, StdCtrls, ExtCtrls, Buttons;
+
+type
+  TFrmRegionEdit = class(TForm)
+    Label1: TLabel;
+    ERegionName: TEdit;
+    Label5: TLabel;
+    Label6: TLabel;
+    Label7: TLabel;
+    Label8: TLabel;
+    Label9: TLabel;
+    Eguardowner: TEdit;
+    Emidilist: TEdit;
+    Erainchancemin: TEdit;
+    ESnowChancemin: TEdit;
+    EResores: TEdit;
+    Erainchancemax: TEdit;
+    ESnowChancemax: TEdit;
+    GroupBox1: TGroupBox;
+    Label3: TLabel;
+    Label4: TLabel;
+    LBSelected: TListBox;
+    LBAvaible: TListBox;
+    Insert: TButton;
+    Remove: TButton;
+    GroupBox2: TGroupBox;
+    BitBtn1: TBitBtn;
+    BitBtn2: TBitBtn;
+    Panel1: TPanel;
+    procedure InsertClick(Sender: TObject);
+    procedure RemoveClick(Sender: TObject);
+    procedure BitBtn1Click(Sender: TObject);
+    procedure BitBtn2Click(Sender: TObject);
+  private
+    { Private declarations }
+  public
+    { Public declarations }
+  end;
+
+var
+  FrmRegionEdit: TFrmRegionEdit;
+
+implementation
+
+uses Spawnregions;
+
+{$R *.dfm}
+
+procedure TFrmRegionEdit.BitBtn1Click(Sender: TObject);
+begin
+  frmRegions.regionname := Eregionname.Text;
+
+  if frmRegions.flags = nil then
+    frmRegions.flags := tstringList.Create
+  else
+    frmRegions.flags.Clear;
+
+  frmRegions.flags.AddStrings(lbselected.Items);
+
+  frmRegions.rainchancemin := strTOint(erainchancemin.Text);
+  frmRegions.rainchancemax := strTOint(erainchancemax.Text);
+  frmRegions.snowchancemin := strTOint(esnowchancemin.Text);
+  frmRegions.snowchancemax := strTOint(esnowchancemax.Text);
+  frmRegions.guardowner := Eguardowner.Text;
+  frmregions.midlist := emidilist.Text;
+  frmregions.resores := eresores.Text;
+  close;
+end;
+
+procedure TFrmRegionEdit.BitBtn2Click(Sender: TObject);
+begin
+  close;
+end;
+
+procedure TFrmRegionEdit.InsertClick(Sender: TObject);
+begin
+if lbavaible.Items.Count &gt; 0 then
+  begin
+    if lbavaible.ItemIndex = -1 then
+      exit;
+
+    lbselected.Items.Add(lbavaible.Items.Strings[lbavaible.ItemIndex]);
+    lbselected.Refresh;
+    lbavaible.Items.Delete(lbavaible.ItemIndex);
+    lbavaible.Refresh;
+  end
+  else
+    showmessage('There`re no more flags avaibles to add.');
+
+end;
+
+procedure TFrmRegionEdit.RemoveClick(Sender: TObject);
+begin
+  if lbselected.Items.Count &gt; 0 then
+  begin
+    if lbselected.ItemIndex = -1 then
+      exit;
+    lbavaible.Items.Add(lbselected.Items.Strings[lbselected.ItemIndex]);
+    lbselected.Items.Delete(lbselected.ItemIndex);
+    lbselected.Refresh;
+    lbavaible.Refresh;
+  end
+  else
+    showmessage('There`re no more flags to remove.');
+end;
+
+end.

Added: trunk/WPGM/src/RegionEditS.dfm
===================================================================
--- trunk/WPGM/src/RegionEditS.dfm	2009-03-17 19:04:31 UTC (rev 6872)
+++ trunk/WPGM/src/RegionEditS.dfm	2009-03-21 04:40:17 UTC (rev 6873)
@@ -0,0 +1,483 @@
+object FrmRegionEditS: TFrmRegionEditS
+  Left = 323
+  Top = 125
+  Caption = 'Spawn Region Edit'
+  ClientHeight = 609
+  ClientWidth = 441
+  Color = clBtnFace
+  Font.Charset = DEFAULT_CHARSET
+  Font.Color = clWindowText
+  Font.Height = -11
+  Font.Name = 'Tahoma'
+  Font.Style = []
+  OldCreateOrder = False
+  Position = poDesktopCenter
+  OnCreate = FormCreate
+  PixelsPerInch = 96
+  TextHeight = 13
+  object Label1: TLabel
+    Left = 62
+    Top = 48
+    Width = 96
+    Height = 13
+    Caption = 'Spanwregion Name:'
+  end
+  object Label2: TLabel
+    Left = 62
+    Top = 108
+    Width = 85
+    Height = 13
+    Caption = 'Max Npc Amount:'
+  end
+  object Label3: TLabel
+    Left = 62
+    Top = 154
+    Width = 31
+    Height = 13
+    Caption = 'Delay:'
+  end
+  object Label4: TLabel
+    Left = 62
+    Top = 216
+    Width = 73
+    Height = 13
+    Caption = 'Npcs per cycle:'
+  end
+  object Label5: TLabel
+    Left = 62
+    Top = 171
+    Width = 20
+    Height = 13
+    Caption = 'Min:'
+  end
+  object Label6: TLabel
+    Left = 134
+    Top = 171
+    Width = 24
+    Height = 13
+    Caption = 'Max:'
+  end
+  object SpeedButton1: TSpeedButton
+    Left = 337
+    Top = 94
+    Width = 23
+    Height = 22
+    Glyph.Data = {
+      36030000424D3603000000000000360000002800000010000000100000000100
+      18000000000000030000120B0000120B00000000000000000000FF00FF078DBE
+      078DBE078DBE078DBE078DBE078DBE078DBE078DBE078DBE078DBE078DBE078D
+      BE078DBEFF00FFFF00FF078DBE25A1D172C7E785D7FA66CDF965CDF965CDF965
+      CDF965CDF865CDF965CDF866CEF939ADD8078DBEFF00FFFF00FF078DBE4CBCE7
+      39A8D1A0E2FB6FD4FA6FD4F96ED4FA6FD4F96FD4FA6FD4FA6FD4FA6ED4F93EB1
+      D984D7EB078DBEFF00FF078DBE72D6FA078DBEAEEAFC79DCFB79DCFB79DCFB79
+      DCFB79DCFB7ADCFB79DCFA79DCFA44B5D9AEF1F9078DBEFF00FF078DBE79DDFB
+      1899C79ADFF392E7FB84E4FB83E4FC83E4FC84E4FC83E4FC83E4FB84E5FC48B9
+      DAB3F4F9078DBEFF00FF078DBE82E3FC43B7DC65C3E0ACF0FD8DEBFC8DEBFC8D
+      EBFD8DEBFD8DEBFC8DEBFD0C85184CBBDAB6F7F96DCAE0078DBE078DBE8AEAFC
+      77DCF3229CC6FDFFFFC8F7FEC9F7FEC9F7FEC9F7FEC8F7FE0C85183CBC5D0C85
+      18DEF9FBD6F6F9078DBE078DBE93F0FE93F0FD1697C5078DBE078DBE078DBE07
+      8DBE078DBE0C851852D97F62ED9741C4650C8518078DBE078DBE078DBE9BF5FE
+      9AF6FE9AF6FE9BF5FD9BF6FE9AF6FE9BF5FE0C851846CE6C59E48858E18861EB
+      9440C1650C8518FF00FF078DBEFEFEFEA0FBFFA0FBFEA0FBFEA1FAFEA1FBFE0C
+      85180C85180C85180C851856E18447CD6E0C85180C85180C8518FF00FF078DBE
+      FEFEFEA5FEFFA5FEFFA5FEFF078CB643B7DC43B7DC43B7DC0C85184EDD7936BA
+      540C8518FF00FFFF00FFFF00FFFF00FF078DBE078DBE078DBE078DBEFF00FFFF
+      00FFFF00FFFF00FF0C851840D0650C8518FF00FFFF00FFFF00FFFF00FFFF00FF
+      FF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FF0C85182AB7432DBA490C85
+      18FF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF
+      00FFFF00FF0C851821B5380C8518FF00FFFF00FFFF00FFFF00FFFF00FFFF00FF
+      FF00FFFF00FFFF00FFFF00FFFF00FF0C85180C85180C85180C8518FF00FFFF00
+      FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FF0C85180C85180C
+      85180C8518FF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FF}
+    OnClick = SpeedButton1Click
+  end
+  object Label7: TLabel
+    Left = 218
+    Top = 76
+    Width = 33
+    Height = 13
+    Caption = 'Group:'
+  end
+  object SpeedButton2: TSpeedButton
+    Left = 364
+    Top = 94
+    Width = 23
+    Height = 22
+    Glyph.Data = {
+      36030000424D3603000000000000360000002800000010000000100000000100
+      18000000000000030000120B0000120B00000000000000000000FF00FFFF00FF
+      FF00FFFF00FFFF00FF01079F0313A90418AE0419AE0313A90108A0FF00FFFF00
+      FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FF01049D041CB10730C00734C407
+      35C50735C50734C30731C1041FB301069EFF00FFFF00FFFF00FFFF00FFFF00FF
+      0109A1052BC30735C70733C20732C20732C20732C20732C20733C30735C4062D
+      BE020CA4FF00FFFF00FFFF00FF01049B052BCA0636D80431CD0027C4032EC107
+      32C20732C20430C10027BF042FC10735C4072EBE01069EFF00FFFF00FF031ABA
+      0537E70331DD123DD86480E01840CB002CC1022DC00F38C46580D91B43C7052F
+      C10735C5051FB3FF00FF01049E0430E40436F1002AE45070E9FFFFFFB7C4F10D
+      36CA042DC3A2B2E8FFFFFF6984DA0026BE0733C30731C10108A0020FAF0336FA
+      0335F80232EE0A35E88CA2F2FFFFFFB4C2F1A9B8EDFFFFFFA7B7E9133AC4052F
+      C10732C20734C40313AA0619BC1747FE093AFC0435F80131F0002BE891A5F4FF
+      FFFFFFFFFFABBAEF062FC5022DC00732C20732C20736C50419AE0B1DBE4168FE
+      1C49FC0335FB0031F90531F2A4B5F7FFFFFFFFFFFFB9C6F20D36D0002CC60732
+      C20732C20736C50418AD0613B45B7CFC486CFD0133FB113CFBA1B4FEFFFFFFA4
+      B6F892A7F5FFFFFFB6C4F21A41D3042FC80732C40734C30212A90003A04A6AF3
+      8FA6FF1F46FB4C6FFCFFFFFFA7B8FE0733F6002AED8CA2F6FFFFFF627FE70028
+      D00734CC0730C300069FFF00FF1A2FCB99AFFF8BA2FE214DFB4D71FC0E3DFB00
+      30FB0031F70636F14C6EF1103CE30432DB0636D7041CB5FF00FFFF00FF0004A0
+      415EECB8C7FF9CAFFD3A5CFC0A3AFB0335FB0335FB0133F9052FF20635EB0537
+      E9052CCD00049CFF00FFFF00FFFF00FF0309A54260ECA9BBFFBDCAFF8EA5FE64
+      83FD5073FC4A6EFD3961FD1444F9042CD70109A2FF00FFFF00FFFF00FFFF00FF
+      FF00FF0004A01E32CD5876F6859EFE8BA3FF7994FE5376FC234AF0051EC50104
+      9CFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FF0004A00917B610
+      22C30D1FC20311B401059FFF00FFFF00FFFF00FFFF00FFFF00FF}
+    OnClick = SpeedButton2Click
+  end
+  object GroupBox2: TGroupBox
+    Left = 64
+    Top = 536
+    Width = 321
+    Height = 57
+    TabOrder = 0
+    object BitBtn1: TBitBtn
+      Left = 46
+      Top = 20
+      Width = 75
+      Height = 25
+      Caption = 'OK'
+      TabOrder = 0
+      OnClick = BitBtn1Click
+    end
+    object BitBtn2: TBitBtn
+      Left = 202
+      Top = 20
+      Width = 75
+      Height = 25
+      Caption = 'Cancel'
+      TabOrder = 1
+      OnClick = BitBtn2Click
+    end
+  end
+  object Panel1: TPanel
+    Left = 12
+    Top = 5
+    Width = 413
+    Height = 27
+    Caption = 'Edit your Region '
+    TabOrder = 1
+  end
+  object ERegionName: TEdit
+    Left = 164
+    Top = 45
+    Width = 223
+    Height = 21
+    TabOrder = 2
+  end
+  object CheckBox1: TCheckBox
+    Left = 61
+    Top = 80
+    Width = 97
+    Height = 13
+    Caption = 'Active'
+    TabOrder = 3
+  end
+  object EMaxnpcamount: TEdit
+    Left = 62
+    Top = 127
+    Width = 121
+    Height = 21
+    TabOrder = 4
+    Text = '0'
+  end
+  object Edelaymin: TEdit
+    Left = 62
+    Top = 185
+    Width = 53
+    Height = 21
+    TabOrder = 5
+    Text = '0'
+  end
+  object Edelaymax: TEdit
+    Left = 134
+    Top = 185
+    Width = 49
+    Height = 21
+    TabOrder = 6
+    Text = '0'
+  end
+  object Enpcspercycle: TEdit
+    Left = 62
+    Top = 235
+    Width = 121
+    Height = 21
+    TabOrder = 7
+    Text = '0'
+  end
+  object ListBox1: TListBox
+    Left = 218
+    Top = 122
+    Width = 169
+    Height = 136
+    ItemHeight = 13
+    TabOrder = 8
+  end
+  object Edit1: TEdit
+    Left = 218
+    Top = 95
+    Width = 113
+    Height = 21
+    TabOrder = 9
+  end
+  object Panel2: TPanel
+    Left = -2
+    Top = 264
+    Width = 443
+    Height = 125
+    TabOrder = 10
+    object Splitter1: TSplitter
+      Left = 157
+      Top = 1
+      Height = 123
+      ExplicitLeft = 202
+      ExplicitHeight = 112
+    end
+    object Splitter2: TSplitter
+      Left = 327
+      Top = 1
+      Height = 123
+      Align = alRight
+      ExplicitLeft = 336
+    end
+    object vtNpcCategories: TVirtualStringTree
+      Left = 1
+      Top = 1
+      Width = 156
+      Height = 123
+      Align = alLeft
+      Header.AutoSizeIndex = 0
+      Header.Font.Charset = DEFAULT_CHARSET
+      Header.Font.Color = clWindowText
+      Header.Font.Height = -11
+      Header.Font.Name = 'MS Sans Serif'
+      Header.Font.Style = []
+      Header.MainColumn = -1
+      Header.Options = [hoColumnResize, hoDrag]
+      IncrementalSearchStart = ssAlwaysStartOver
+      ScrollBarOptions.AlwaysVisible = True
+      TabOrder = 0
+      TreeOptions.PaintOptions = [toShowButtons, toShowRoot, toShowTreeLines, toThemeAware, toUseBlendedImages]
+      OnChange = vtNpcCategoriesChange
+      OnExpanding = vtNpcCategoriesExpanding
+      OnGetText = vtNpcCategoriesGetText
+      Columns = &lt;&gt;
+    end
+    object vtNpcs: TVirtualStringTree
+      Left = 160
+      Top = 1
+      Width = 167
+      Height = 123
+      Align = alClient
+      Header.AutoSizeIndex = 0
+      Header.Font.Charset = DEFAULT_CHARSET
+      Header.Font.Color = clWindowText
+      Header.Font.Height = -11
+      Header.Font.Name = 'MS Sans Serif'
+      Header.Font.Style = []
+      Header.Options = [hoColumnResize, hoDrag, hoShowSortGlyphs, hoVisible]
+      Header.SortColumn = 0
+      ScrollBarOptions.AlwaysVisible = True
+      ScrollBarOptions.ScrollBars = ssVertical
+      TabOrder = 1
+      TreeOptions.AutoOptions = [toAutoDropExpand, toAutoScrollOnExpand, toAutoSort, toAutoTristateTracking, toAutoDeleteMovedNodes, toAutoFreeOnCollapse]
+      TreeOptions.PaintOptions = [toHideFocusRect, toShowButtons, toThemeAware, toUseBlendedImages]
+      TreeOptions.SelectionOptions = [toDisableDrawSelection, toFullRowSelect]
+      OnChange = vtNpcsChange
+      OnCompareNodes = vtNpcsCompareNodes
+      OnGetText = vtNpcsGetText
+      OnHeaderClick = vtNpcsHeaderClick
+      ExplicitWidth = 177
+      Columns = &lt;
+        item
+          Position = 0
+          Width = 100
+          WideText = 'Name'
+        end
+        item
+          Position = 1
+          WideText = 'ID'
+        end&gt;
+    end
+    object pbNpcPreview: TPaintBox32
+      Left = 330
+      Top = 1
+      Width = 112
+      Height = 123
+      Align = alRight
+      TabOrder = 2
+      OnPaintBuffer = pbNpcPreviewPaintBuffer
+      ExplicitLeft = 340
+    end
+  end
+  object GroupBox1: TGroupBox
+    Left = 2
+    Top = 394
+    Width = 439
+    Height = 50
+    Caption = 'Npc Wander'
+    TabOrder = 11
+    object Label8: TLabel
+      Left = 162
+      Top = 22
+      Width = 16
+      Height = 13
+      Caption = 'x1:'
+    end
+    object Label9: TLabel
+      Left = 229
+      Top = 22
+      Width = 16
+      Height = 13
+      Caption = 'y1:'
+    end
+    object Label10: TLabel
+      Left = 300
+      Top = 22
+      Width = 16
+      Height = 13
+      Caption = 'x2:'
+    end
+    object Label11: TLabel
+      Left = 369
+      Top = 22
+      Width = 16
+      Height = 13
+      Caption = 'y2:'
+    end
+    object ComboBox1: TComboBox
+      Left = 23
+      Top = 20
+      Width = 133
+      Height = 21
+      ItemHeight = 13
+      TabOrder = 0
+      OnChange = ComboBox1Change
+      Items.Strings = (
+        'rectangle'
+        'circle'
+        'freely'
+        'none')
+    end
+    object Ex1: TEdit
+      Left = 179
+      Top = 19
+      Width = 48
+      Height = 21
+      TabOrder = 1
+      Text = '0'
+    end
+    object Ey1: TEdit
+      Left = 247
+      Top = 19
+      Width = 48
+      Height = 21
+      TabOrder = 2
+      Text = '0'
+    end
+    object Ex2: TEdit
+      Left = 315
+      Top = 19
+      Width = 48
+      Height = 21
+      TabOrder = 3
+      Text = '0'
+    end
+    object Ey2: TEdit
+      Left = 386
+      Top = 19
+      Width = 48
+      Height = 21
+      TabOrder = 4
+      Text = '0'
+    end
+  end
+  object DBGNpc: TDBGrid
+    Left = 43
+    Top = 450
+    Width = 398
+    Height = 80
+    DataSource = DataSource1
+    TabOrder = 12
+    TitleFont.Charset = DEFAULT_CHARSET
+    TitleFont.Color = clWindowText
+    TitleFont.Height = -11
+    TitleFont.Name = 'Tahoma'
+    TitleFont.Style = []
+    Columns = &lt;
+      item
+        Expanded = False
+        FieldName = 'Id'
+        Width = 100
+        Visible = True
+      end
+      item
+        Expanded = False
+        FieldName = 'WanderType'
+        Width = 70
+        Visible = True
+      end
+      item
+        Expanded = False
+        FieldName = 'x1'
+        Width = 45
+        Visible = True
+      end
+      item
+        Expanded = False
+        FieldName = 'x2'
+        Width = 45
+        Visible = True
+      end
+      item
+        Expanded = False
+        FieldName = 'y1'
+        Width = 45
+        Visible = True
+      end
+      item
+        Expanded = False
+        FieldName = 'y2'
+        Width = 45
+        Visible = True
+      end&gt;
+  end
+  object Badd: TButton
+    Left = 1
+    Top = 450
+    Width = 36
+    Height = 39
+    Caption = 'Add'
+    TabOrder = 13
+    OnClick = BaddClick
+  end
+  object bdel: TButton
+    Left = 1
+    Top = 491
+    Width = 36
+    Height = 39
+    Caption = 'Del'
+    TabOrder = 14
+    OnClick = bdelClick
+  end
+  object DataSource1: TDataSource
+    AutoEdit = False
+    DataSet = frmRegions.CDSNpc
+    Left = 42
+    Top = 540
+  end
+  object animtimer: TTimer
+    Enabled = False
+    Interval = 100
+    OnTimer = animtimerTimer
+    Left = 572
+    Top = 24
+  end
+end

Added: trunk/WPGM/src/RegionEditS.pas
===================================================================
--- trunk/WPGM/src/RegionEditS.pas	2009-03-17 19:04:31 UTC (rev 6872)
+++ trunk/WPGM/src/RegionEditS.pas	2009-03-21 04:40:17 UTC (rev 6873)
@@ -0,0 +1,556 @@
+unit RegionEditS;
+
+interface
+
+uses
+  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
+  Dialogs, ExtCtrls, StdCtrls, Buttons, DB, Grids, DBGrids, GR32_Image,
+  VirtualTrees, GR32, SQLite3, SQLiteTable3, UOAnim, uConfig;
+
+type
+  TFrmRegionEditS = class(TForm)
+    GroupBox2: TGroupBox;
+    BitBtn1: TBitBtn;
+    BitBtn2: TBitBtn;
+    Panel1: TPanel;
+    Label1: TLabel;
+    ERegionName: TEdit;
+    Label2: TLabel;
+    Label3: TLabel;
+    Label4: TLabel;
+    Label5: TLabel;
+    Label6: TLabel;
+    SpeedButton1: TSpeedButton;
+    Label7: TLabel;
+    SpeedButton2: TSpeedButton;
+    CheckBox1: TCheckBox;
+    EMaxnpcamount: TEdit;
+    Edelaymin: TEdit;
+    Edelaymax: TEdit;
+    Enpcspercycle: TEdit;
+    ListBox1: TListBox;
+    Edit1: TEdit;
+    Panel2: TPanel;
+    Splitter1: TSplitter;
+    Splitter2: TSplitter;
+    vtNpcCategories: TVirtualStringTree;
+    vtNpcs: TVirtualStringTree;
+    pbNpcPreview: TPaintBox32;
+    GroupBox1: TGroupBox;
+    Label8: TLabel;
+    Label9: TLabel;
+    Label10: TLabel;
+    Label11: TLabel;
+    ComboBox1: TComboBox;
+    Ex1: TEdit;
+    Ey1: TEdit;
+    Ex2: TEdit;
+    Ey2: TEdit;
+    DBGNpc: TDBGrid;
+    Badd: TButton;
+    bdel: TButton;
+    DataSource1: TDataSource;
+    animtimer: TTimer;
+    procedure ComboBox1Change(Sender: TObject);
+     procedure vtNpcCategoriesChange(Sender: TBaseVirtualTree;
+      Node: PVirtualNode);
+    procedure vtNpcsChange(Sender: TBaseVirtualTree; Node: PVirtualNode);
+    procedure vtNpcsCompareNodes(Sender: TBaseVirtualTree; Node1,
+      Node2: PVirtualNode; Column: TColumnIndex; var Result: Integer);
+    procedure vtNpcsGetText(Sender: TBaseVirtualTree; Node: PVirtualNode;
+      Column: TColumnIndex; TextType: TVSTTextType; var CellText: WideString);
+    procedure vtNpcsHeaderClick(Sender: TVTHeader; Column: TColumnIndex;
+      Button: TMouseButton; Shift: TShiftState; X, Y: Integer);
+    procedure pbNpcPreviewPaintBuffer(Sender: TObject);
+    procedure FormCreate(Sender: TObject);
+    procedure FormClose(Sender: TObject; var Action: TCloseAction);
+    procedure vtNpcCategoriesExpanding(Sender: TBaseVirtualTree;
+      Node: PVirtualNode; var Allowed: Boolean);
+    procedure vtNpcCategoriesGetText(Sender: TBaseVirtualTree;
+      Node: PVirtualNode; Column: TColumnIndex; TextType: TVSTTextType;
+      var CellText: WideString);
+    procedure animtimerTimer(Sender: TObject);
+    procedure BaddClick(Sender: TObject);
+    procedure SpeedButton1Click(Sender: TObject);
+    procedure SpeedButton2Click(Sender: TObject);
+    procedure bdelClick(Sender: TObject);
+    procedure BitBtn1Click(Sender: TObject);
+    procedure BitBtn2Click(Sender: TObject);
+  private
+    { Private declarations }
+  public
+    { Public declarations }
+  end;
+
+
+
+var
+  FrmRegionEditS: TFrmRegionEditS;
+  npcPreview: Array of TAnimation;
+  npcPreviewFrame: Integer;
+  selectedId : string;
+
+
+implementation
+
+uses Main,Math, Spawnregions;
+
+{$R *.dfm}
+
+procedure TFrmRegionEditS.animtimerTimer(Sender: TObject);
+begin
+  if (npcPreview &lt;&gt; nil) and (npcPreview[0].frameCount &gt; 0) then begin
+    npcPreviewFrame := (npcPreviewFrame + 1) mod npcPreview[0].frameCount;
+    pbNpcPreview.Invalidate;
+  end;
+end;
+  
+
+
+procedure TFrmRegionEditS.BaddClick(Sender: TObject);
+begin
+  if combobox1.ItemIndex = -1 then
+  begin
+    showmessage('You must select a wandertype!');
+    exit;
+  end;
+
+  frmRegions.CDSNpc.Append;
+  frmregions.CDSNpcId.AsString := selectedId;
+  frmregions.CDSNpcWanderType.AsString := combobox1.Items.Strings[combobox1.ItemIndex];
+  frmregions.CDSNpcx1.AsString := ex1.Text;
+  frmregions.CDSNpcy1.AsString := ey1.Text;
+  frmregions.CDSNpcx2.AsString := ex2.Text;
+  frmregions.CDSNpcy2.AsString := ey1.Text;
+  frmregions.CDSNpc.Post;
+
+end;
+
+procedure TFrmRegionEditS.bdelClick(Sender: TObject);
+begin
+  if not frmRegions.CDSNpc.Eof then
+    frmregions.cdsnpc.Delete;
+
+end;
+
+procedure TFrmRegionEditS.BitBtn1Click(Sender: TObject);
+begin
+  frmRegions.regionname := Eregionname.Text;
+
+  if frmRegions.group = nil then
+    frmRegions.group := tstringList.Create
+  else
+    frmRegions.group.Clear;
+
+  frmRegions.group.AddStrings(listbox1.Items);
+
+
+  frmregions.active := active;
+  frmregions.maxnpcamount := strtoint(emaxnpcamount.Text);
+  frmregions.delaymin := strtoint(edelaymin.Text);
+  frmregions.delaymax := strtoint(edelaymax.Text);
+  frmregions.npcspercycle := strtoint(enpcspercycle.Text);
+  close;
+
+end;
+
+procedure TFrmRegionEditS.BitBtn2Click(Sender: TObject);
+begin
+  close;
+end;
+
+procedure TFrmRegionEditS.ComboBox1Change(Sender: TObject);
+begin
+    case combobox1.ItemIndex  of
+      0: begin
+            label8.Visible := true;
+            label9.Visible := true;
+            label10.Visible := true;
+            label11.Visible := true;
+            ex1.Visible := true;
+            ey1.Visible := true;
+            ex2.Visible := true;
+            ey2.Visible := true;
+         end;
+      1: begin
+            label8.Visible := true;
+            label9.Visible := false;
+            label10.Visible := false;
+            label11.Visible := false;
+            ex1.Visible := true;
+            ey1.Visible := false;
+            ex2.Visible := false;
+            ey2.Visible := false;
+         end;
+      2: begin
+            label8.Visible := false;
+            label9.Visible := false;
+            label10.Visible := false;
+            label11.Visible := false;
+            ex1.Visible := false;
+            ey1.Visible := false;
+            ex2.Visible := false;
+            ey2.Visible := false;
+          end;
+      3: begin
+            label8.Visible := false;
+            label9.Visible := false;
+            label10.Visible := false;
+            label11.Visible := false;
+            ex1.Visible := false;
+            ey1.Visible := false;
+            ex2.Visible := false;
+            ey2.Visible := false;
+
+         end;
+    end;
+end;
+
+procedure TFrmRegionEditS.FormClose(Sender: TObject; var Action: TCloseAction);
+begin
+  cafree;
+end;
+
+procedure TFrmRegionEditS.FormCreate(Sender: TObject);
+var
+  Config: TConfig;
+      RootQuery: TSQLiteTable;
+    CountQuery: TSQLiteTable;
+    Node: PNode;
+    TreeNode: PVirtualNode;
+begin
+    frmRegions.CDSNpc.Open;
+
+    npcPreview := nil;
+    npcPreviewFrame := 0;
+    Config := TConfig.Create;
+    Config.Load(ExtractFilePath( Application.ExeName ) + 'config.ini');
+
+    vtNpcCategories.NodeDataSize := sizeof(TNode);
+
+    vtNpcs.NodeDataSize := sizeof( TNpcNode );
+
+
+    // Query initial count of Items
+    try
+      //    TSQLiteDatabase
+    	SQLiteDb := TSQLiteDatabase.Create( 'categories.db' );
+        SQLiteDb.ExecSQL( 'PRAGMA default_cache_size = 10000;' );
+        SQLiteDb.ExecSQL( 'PRAGMA default_synchronous = OFF;' );
+        SQLiteDb.ExecSQL( 'PRAGMA full_column_names = OFF;' );
+        SQLiteDb.ExecSQL( 'PRAGMA show_datatypes = OFF;' );
+
+        if not SqLitedb.TableExists('categories') then
+        begin
+          // Table not exists, maybe databse don't exists too
+          Application.MessageBox(PChar('Please check you categories.db, It''s corrupted'), 'Error', MB_OK+MB_ICONERROR );
+          exit;
+        end;
+
+        //RootQuery.Free;
+
+        RootQuery := TSQLiteTable.Create( SQLiteDb, 'SELECT id,name FROM npccategories WHERE type = 0 AND parent = 0 ORDER BY name ASC;' );
+        while not RootQuery.EOF do
+        begin
+          TreeNode := vtNpcCategories.AddChild( nil );
+          Node := vtNpcCategories.GetNodeData( TreeNode );
+          Node.Id := StrToInt( RootQuery.Fields[0] );
+          Node.Name := UTF8Decode(RootQuery.Fields[1]);
+          TreeNode.States := [ vsInitialized ] + TreeNode.States;
+
+          // Check for Children
+          CountQuery := SQLiteDb.GetTable( Format( 'SELECT COUNT(*) FROM npccategories WHERE type = 0 AND parent = %u', [ Node.Id ] ) );
+
+          if StrToInt(CountQuery.Fields[0]) &gt; 0 then
+            TreeNode.States := [ vsHasChildren ] + TreeNode.States;
+          CountQuery.Free;
+          RootQuery.Next;
+        end;
+        RootQuery.Free;
+
+    except
+    	on E: Exception do
+        begin
+	    	Application.MessageBox(PChar(E.Message), 'Error', MB_OK+MB_ICONERROR );
+	        PostQuitMessage( 0 );
+	        Exit;
+        end;
+    end;
+ end;
+
+procedure TFrmRegionEditS.pbNpcPreviewPaintBuffer(Sender: TObject);
+var
+  pb: TPaintBox32;
+  totalHeight, totalWidth, i, xpos, ypos: Integer;
+  frame: PAnimFrame;
+begin
+  if not (Sender is TPaintBox32) then
+    exit;
+
+  pb := Sender as TPaintBox32;
+  pb.Buffer.Clear(clGray32);
+
+  // Draw Centered
+  if (npcPreview &lt;&gt; nil) and (length(npcPreview) &gt; 0) then begin
+    // Measure Total Height and Width
+    totalHeight := 0;
+    totalWidth := 0;
+
+    for i := 0 to Length(npcPreview) - 1 do begin
+      totalHeight := Max(npcPreview[i].getTotalHeight, totalHeight);
+      totalWidth := Max(npcPreview[i].getTotalWidth, totalWidth);
+    end;
+
+    xpos := (pb.ClientWidth div 2);
+    ypos := (pb.ClientHeight div 2) + (totalHeight div 2);
+
+    for i := 0 to Length(npcPreview) - 1 do begin
+      frame := npcPreview[i].getFrame(npcPreviewFrame);
+
+      if frame &lt;&gt; nil then begin
+        pb.Buffer.Draw(xpos - frame.CenterX, ypos - frame.image.height - frame.CenterY, frame.Image);
+      end;
+    end;
+  end;
+end;
+
+procedure TFrmRegionEditS.SpeedButton1Click(Sender: TObject);
+begin
+  if length(trim(edit1.Text)) &lt;&gt; 0 then
+    listbox1.Items.Add(edit1.text);
+end;
+
+procedure TFrmRegionEditS.SpeedButton2Click(Sender: TObject);
+begin
+    if listbox1.ItemIndex &lt;&gt; -1 then
+    listbox1.DeleteSelected;
+end;
+
+procedure TFrmRegionEditS.vtNpcCategoriesChange(Sender: TBaseVirtualTree;
+  Node: PVirtualNode);
+var
+	MyData: PNode;
+  ItemData: PNpcNode;
+	Query, SubQuery: TSQLiteTable;
+  TreeNode: PVirtualNode;
+  i: Integer;
+begin
+    vtNpcs.Clear;
+
+    if Node = nil then
+        Exit;
+
+    MyData := Sender.GetNodeData(Node);
+    try
+      Query := TSQLiteTable.Create( SQLiteDb, Format( 'SELECT id,name,bodyid,addid,skin FROM npcs WHERE parent = %u ORDER BY name;', [ MyData.Id ] ) );
+      while not Query.EOF do
+      begin
+        TreeNode := vtNpcs.AddChild( nil );
+        ItemData := vtNpcs.GetNodeData( TreeNode );
+
+        ItemData.Id := StrToInt( Query.Fields[0] );
+        ItemData.Name := UTF8Decode(Query.Fields[1]);
+        ItemData.BodyId := StrToInt( Query.Fields[2] );
+        ItemData.AddId := Query.Fields[3];
+        ItemData.Skin := StrToIntDef( Query.Fields[4], 0);
+
+        SubQuery := TSQLiteTable.Create(SQLiteDb, Format('SELECT layer,artid,color FROM npcequipment WHERE id = %u ORDER BY layer DESC', [ ItemData.Id ] ) );
+
+        while not SubQuery.Eof do
+        begin
+          i := Length(ItemData.Equipment);
+          SetLength(ItemData.Equipment, i + 1);
+          ItemData.Equipment[i].Layer := StrToInt( SubQuery.Fields[0] );
+          ItemData.Equipment[i].Anim := StrToInt( SubQuery.Fields[1] );
+          ItemData.Equipment[i].Color := StrToInt( SubQuery.Fields[2] );
+          SubQuery.Next;
+        end;
+
+        SubQuery.Free;
+
+        Query.Next;
+      end;
+      Query.Free;
+      vtNpcs.SortTree(vtNpcs.Header.SortColumn, vtNpcs.Header.SortDirection);
+    except
+    	on E: Exception do
+        begin
+	    	Application.MessageBox( PChar( 'Error retrieving ChildCount: ' + E.Message ), 'Error', MB_OK+MB_ICONERROR );
+	        PostQuitMessage( 0 );
+	        Exit;
+        end;
+    end;
+end;
+
+procedure TFrmRegionEditS.vtNpcCategoriesExpanding(Sender: TBaseVirtualTree;
+  Node: PVirtualNode; var Allowed: Boolean);
+var
+	MyData: PNode;
+    RootQuery, CountQuery: TSQLiteTable;
+    TreeNode: PVirtualNode;
+begin
+	// Children Already Added
+    if ( Sender.ChildCount[ Node ] &gt; 0 ) or not ( vsHasChildren in Node.States ) then
+    	exit;
+
+	// Add the Children
+    MyData := Sender.GetNodeData( Node );
+
+	try
+        RootQuery := TSQLiteTable.Create( SQLiteDb, Format( 'SELECT id,name FROM npccategories WHERE type = 0 AND parent = %u ORDER BY name ASC;', [ MyData.Id ] ) );
+
+        while not RootQuery.EOF do
+        begin
+	        TreeNode := vtNpcCategories.AddChild( Node );
+            MyData := vtNpcCategories.GetNodeData( TreeNode );
+            MyData.Id := StrToInt( RootQuery.Fields[0] );
+            MyData.Name := UTF8Decode(RootQuery.Fields[1]);
+            TreeNode.States := [ vsInitialized ] + TreeNode.States;
+
+            // Check for Children
+            CountQuery := SQLiteDb.GetTable( Format( 'SELECT COUNT(*) FROM npccategories WHERE type = 0 AND parent = %u', [ MyData.Id ] ) );
+
+			if StrToInt( CountQuery.Fields[0] ) &gt; 0 then
+            	TreeNode.States := [ vsHasChildren ] + TreeNode.States;
+
+            CountQuery.Free;
+
+            RootQuery.Next;
+        end;
+
+        RootQuery.Free;
+    except
+    	on E: Exception do
+      begin
+        Application.MessageBox( PChar( E.Message ), 'Error', MB_OK+MB_ICONERROR );
+        PostQuitMessage( 0 );
+        Exit;
+      end;
+    end;
+end;
+
+
+procedure TFrmRegionEditS.vtNpcCategoriesGetText(Sender: TBaseVirtualTree;
+  Node: PVirtualNode; Column: TColumnIndex; TextType: TVSTTextType;
+  var CellText: WideString);
+begin
+  if TextType = ttNormal then
+  	CellText := PNode( Sender.GetNodeData( Node ) ).Name;
+end;
+
+procedure TFrmRegionEditS.vtNpcsChange(Sender: TBaseVirtualTree;
+  Node: PVirtualNode);
+var
+	MyItemData: PNpcNode;
+  frames: TAnimation;
+  i, j: Integer;
+
+  const LayerOrder: Array[0..21] of Byte = ( 20, 5, 4, 3, 24, 23, 13, 19, 17, 22, 12, 14, 8, 7, 1, 2, 10, 16, 11, 18, 6, 21 );
+begin
+  animtimer.Enabled := false;
+
+  for i := 0 to Length(npcPreview) - 1 do
+    npcPreview[i].Free;
+
+  SetLength(npcPreview, 0);
+
+  // Display a Preview Item
+  if Node &lt;&gt; nil then
+  begin
+    MyItemData := Sender.GetNodeData(Node);
+    selectedId := Myitemdata.AddId;
+
+    frames := Anim.GetFrames(MyItemData.BodyId, 1, MyItemData.Skin);
+    
+    if frames &lt;&gt; nil then begin
+      SetLength(npcPreview, 1);
+      npcPreview[0] := frames;
+
+      // Add Equipment
+      for j := 0 to Length(LayerOrder) - 1 do begin
+        for i := 0 to Length(MyItemData.Equipment) - 1 do begin
+          if MyItemData.Equipment[i].Layer = LayerOrder[j] then begin
+            frames := Anim.GetFrames(MyItemData.Equipment[i].Anim, 1, MyItemData.Equipment[i].Color);
+            if frames &lt;&gt; nil then begin
+              SetLength(npcPreview, Length(npcPreview) + 1);
+              npcPreview[Length(npcPreview) - 1] := frames;
+            end;
+          end;
+        end;
+      end;
+
+      npcPreviewFrame := 0;
+      pbNpcPreview.Invalidate;
+      animtimer.Interval := npcPreview[0].frameDelay;
+      animtimer.Enabled := true;
+    end;
+
+  end else begin
+    pbNpcPreview.Invalidate;
+  end;
+
+
+  // See if there is some selected node
+  Node := vtNpcs.RootNode.FirstChild;
+  while Node &lt;&gt; nil do
+  begin
+    if vsSelected in Node.States then
+    begin
+      exit;
+    end;
+    Node := Node.NextSibling;
+  end;
+end;
+
+procedure TFrmRegionEditS.vtNpcsCompareNodes(Sender: TBaseVirtualTree; Node1,
+  Node2: PVirtualNode; Column: TColumnIndex; var Result: Integer);
+var
+	MyData1, MyData2: PNpcNode;
+begin
+	MyData1 := Sender.GetNodeData( Node1 );
+	MyData2 := Sender.GetNodeData( Node2 );
+
+    case Column of
+        0: Result := CompareStr( MyData1.Name, MyData2.Name );
+        1: Result := CompareStr( MyData1.AddId, MyData2.AddId );
+    end;
+
+end;
+
+procedure TFrmRegionEditS.vtNpcsGetText(Sender: TBaseVirtualTree;
+  Node: PVirtualNode; Column: TColumnIndex; TextType: TVSTTextType;
+  var CellText: WideString);
+var
+	MyData: PNpcNode;
+begin
+	MyData := Sender.GetNodeData( Node );
+
+    case Column of
+		    0: CellText := MyData.Name;
+        1: CellText := MyData.AddId;
+    end;
+end;
+
+procedure TFrmRegionEditS.vtNpcsHeaderClick(Sender: TVTHeader;
+  Column: TColumnIndex; Button: TMouseButton; Shift: TShiftState; X,
+  Y: Integer);
+begin
+	// When changing we keep our sort direction
+    if Sender.SortColumn = Column then
+    begin
+		if Sender.SortDirection = sdAscending then
+        	Sender.SortDirection := sdDescending
+        else
+            Sender.SortDirection := sdAscending;
+        exit;
+    end;
+
+  	Sender.SortColumn := Column;
+    Sender.SortDirection := sdAscending;
+
+
+end;
+
+
+
+end.

Modified: trunk/WPGM/src/RegionWizard3Spawn.dfm
===================================================================
--- trunk/WPGM/src/RegionWizard3Spawn.dfm	2009-03-17 19:04:31 UTC (rev 6872)
+++ trunk/WPGM/src/RegionWizard3Spawn.dfm	2009-03-21 04:40:17 UTC (rev 6873)
@@ -97,31 +97,31 @@
     Height = 22
     Glyph.Data = {
       36030000424D3603000000000000360000002800000010000000100000000100
-      18000000000000030000120B0000120B00000000000000000000FF00FF078DBE
-      078DBE078DBE078DBE078DBE078DBE078DBE078DBE078DBE078DBE078DBE078D
-      BE078DBEFF00FFFF00FF078DBE25A1D172C7E785D7FA66CDF965CDF965CDF965
-      CDF965CDF865CDF965CDF866CEF939ADD8078DBEFF00FFFF00FF078DBE4CBCE7
-      39A8D1A0E2FB6FD4FA6FD4F96ED4FA6FD4F96FD4FA6FD4FA6FD4FA6ED4F93EB1
-      D984D7EB078DBEFF00FF078DBE72D6FA078DBEAEEAFC79DCFB79DCFB79DCFB79
-      DCFB79DCFB7ADCFB79DCFA79DCFA44B5D9AEF1F9078DBEFF00FF078DBE79DDFB
-      1899C79ADFF392E7FB84E4FB83E4FC83E4FC84E4FC83E4FC83E4FB84E5FC48B9
-      DAB3F4F9078DBEFF00FF078DBE82E3FC43B7DC65C3E0ACF0FD8DEBFC8DEBFC8D
-      EBFD8DEBFD8DEBFC8DEBFD0C85184CBBDAB6F7F96DCAE0078DBE078DBE8AEAFC
-      77DCF3229CC6FDFFFFC8F7FEC9F7FEC9F7FEC9F7FEC8F7FE0C85183CBC5D0C85
-      18DEF9FBD6F6F9078DBE078DBE93F0FE93F0FD1697C5078DBE078DBE078DBE07
-      8DBE078DBE0C851852D97F62ED9741C4650C8518078DBE078DBE078DBE9BF5FE
-      9AF6FE9AF6FE9BF5FD9BF6FE9AF6FE9BF5FE0C851846CE6C59E48858E18861EB
-      9440C1650C8518FF00FF078DBEFEFEFEA0FBFFA0FBFEA0FBFEA1FAFEA1FBFE0C
-      85180C85180C85180C851856E18447CD6E0C85180C85180C8518FF00FF078DBE
-      FEFEFEA5FEFFA5FEFFA5FEFF078CB643B7DC43B7DC43B7DC0C85184EDD7936BA
-      540C8518FF00FFFF00FFFF00FFFF00FF078DBE078DBE078DBE078DBEFF00FFFF
-      00FFFF00FFFF00FF0C851840D0650C8518FF00FFFF00FFFF00FFFF00FFFF00FF
-      FF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FF0C85182AB7432DBA490C85
-      18FF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF
-      00FFFF00FF0C851821B5380C8518FF00FFFF00FFFF00FFFF00FFFF00FFFF00FF
-      FF00FFFF00FFFF00FFFF00FFFF00FF0C85180C85180C85180C8518FF00FFFF00
-      FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FF0C85180C85180C
-      85180C8518FF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FF}
+      18000000000000030000120B0000120B00000000000000000000FF00FFFF00FF
+      FF00FFFF00FFFF00FF01079F0313A90418AE0419AE0313A90108A0FF00FFFF00
+      FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FF01049D041CB10730C00734C407
+      35C50735C50734C30731C1041FB301069EFF00FFFF00FFFF00FFFF00FFFF00FF
+      0109A1052BC30735C70733C20732C20732C20732C20732C20733C30735C4062D
+      BE020CA4FF00FFFF00FFFF00FF01049B052BCA0636D80431CD0027C4032EC107
+      32C20732C20430C10027BF042FC10735C4072EBE01069EFF00FFFF00FF031ABA
+      0537E70331DD123DD86480E01840CB002CC1022DC00F38C46580D91B43C7052F
+      C10735C5051FB3FF00FF01049E0430E40436F1002AE45070E9FFFFFFB7C4F10D
+      36CA042DC3A2B2E8FFFFFF6984DA0026BE0733C30731C10108A0020FAF0336FA
+      0335F80232EE0A35E88CA2F2FFFFFFB4C2F1A9B8EDFFFFFFA7B7E9133AC4052F
+      C10732C20734C40313AA0619BC1747FE093AFC0435F80131F0002BE891A5F4FF
+      FFFFFFFFFFABBAEF062FC5022DC00732C20732C20736C50419AE0B1DBE4168FE
+      1C49FC0335FB0031F90531F2A4B5F7FFFFFFFFFFFFB9C6F20D36D0002CC60732
+      C20732C20736C50418AD0613B45B7CFC486CFD0133FB113CFBA1B4FEFFFFFFA4
+      B6F892A7F5FFFFFFB6C4F21A41D3042FC80732C40734C30212A90003A04A6AF3
+      8FA6FF1F46FB4C6FFCFFFFFFA7B8FE0733F6002AED8CA2F6FFFFFF627FE70028
+      D00734CC0730C300069FFF00FF1A2FCB99AFFF8BA2FE214DFB4D71FC0E3DFB00
+      30FB0031F70636F14C6EF1103CE30432DB0636D7041CB5FF00FFFF00FF0004A0
+      415EECB8C7FF9CAFFD3A5CFC0A3AFB0335FB0335FB0133F9052FF20635EB0537
+      E9052CCD00049CFF00FFFF00FFFF00FF0309A54260ECA9BBFFBDCAFF8EA5FE64
+      83FD5073FC4A6EFD3961FD1444F9042CD70109A2FF00FFFF00FFFF00FFFF00FF
+      FF00FF0004A01E32CD5876F6859EFE8BA3FF7994FE5376FC234AF0051EC50104
+      9CFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FF0004A00917B610
+      22C30D1FC20311B401059FFF00FFFF00FFFF00FFFF00FFFF00FF}
     OnClick = SpeedButton2Click
   end
   object CheckBox1: TCheckBox

Modified: trunk/WPGM/src/RegionWizard4Spawn.pas
===================================================================
--- trunk/WPGM/src/RegionWizard4Spawn.pas	2009-03-17 19:04:31 UTC (rev 6872)
+++ trunk/WPGM/src/RegionWizard4Spawn.pas	2009-03-21 04:40:17 UTC (rev 6873)
@@ -190,8 +190,7 @@
     CountQuery: TSQLiteTable;
     Node: PNode;
     TreeNode: PVirtualNode;
-    i: Integer;
-    value: String;
+
 begin
     frmRegions.CDSNpc.Open;
 

Modified: trunk/WPGM/src/Spawnregions.dfm
===================================================================
--- trunk/WPGM/src/Spawnregions.dfm	2009-03-17 19:04:31 UTC (rev 6872)
+++ trunk/WPGM/src/Spawnregions.dfm	2009-03-21 04:40:17 UTC (rev 6873)
@@ -22,63 +22,54 @@
   PixelsPerInch = 96
   TextHeight = 13
   object Label1: TLabel
-    Left = 161
-    Top = 488
+    Left = 159
+    Top = 494
     Width = 96
     Height = 13
     Anchors = [akLeft, akBottom]
     Caption = 'Screen Coordinates:'
-    ExplicitTop = 468
   end
   object Label2: TLabel
-    Left = 417
-    Top = 488
+    Left = 365
+    Top = 494
     Width = 83
     Height = 13
     Anchors = [akLeft, akBottom]
     Caption = 'Map Coordinates:'
-    ExplicitTop = 468
   end
   object lblScreen: TLabel
-    Left = 264
-    Top = 488
+    Left = 261
+    Top = 494
     Width = 3
     Height = 13
     Anchors = [akLeft, akBottom]
-    ExplicitTop = 468
   end
   object lblMap: TLabel
-    Left = 512
-    Top = 488
+    Left = 460
+    Top = 494
     Width = 3
     Height = 13
     Anchors = [akLeft, akBottom]
-    ExplicitTop = 468
   end
-  object Label3: TLabel
+  object Label6: TLabel
     Left = 624
-    Top = 264
-    Width = 55
+    Top = 42
+    Width = 42
     Height = 13
     Anchors = [akTop, akRight]
-    Caption = 'Selected:'
-    Font.Charset = DEFAULT_CHARSET
-    Font.Color = clWindowText
-    Font.Height = -11
-    Font.Name = 'MS Sans Serif'
-    Font.Style = [fsBold]
-    ParentFont = False
+    Caption = 'Regions:'
   end
-  object lblSelected: TLabel
+  object Label7: TLabel
     Left = 624
-    Top = 283
-    Width = 3
+    Top = 269
+    Width = 57
     Height = 13
     Anchors = [akTop, akRight]
+    Caption = 'Rectangles:'
   end
   object cbMap: TComboBox
     Left = 8
-    Top = 484
+    Top = 488
     Width = 145
     Height = 21
     Style = csDropDownList
@@ -87,19 +78,19 @@
     ItemIndex = 0
     TabOrder = 0
     Text = 'Felucca'
+    OnChange = cbMapChange
     Items.Strings = (
       'Felucca'
       'Trammel'
       'Ilshenar'
       'Malas'
       'Tokuno Islands')
-    ExplicitTop = 464
   end
   object pbMap: TPaintBox32
     Left = 3
-    Top = 28
+    Top = 42
     Width = 597
-    Height = 433
+    Height = 423
     Anchors = [akLeft, akTop, akRight, akBottom]
     TabOrder = 1
     OnMouseDown = pbMapMouseDown
@@ -108,8 +99,8 @@
     OnPaintBuffer = pbMapPaintBuffer
   end
   object sbX: TScrollBar
-    Left = 4
-    Top = 460
+    Left = 3
+    Top = 465
     Width = 597
     Height = 17
     Anchors = [akLeft, akRight, akBottom]
@@ -120,9 +111,9 @@
   end
   object sbY: TScrollBar
     Left = 601
-    Top = 28
+    Top = 42
     Width = 17
-    Height = 432
+    Height = 423
     Anchors = [akTop, akRight, akBottom]
     Kind = sbVertical
     LargeChange = 50
@@ -132,9 +123,9 @@
   end
   object lbRects: TListBox
     Left = 624
-    Top = 28
-    Width = 121
-    Height = 198
+    Top = 284
+    Width = 124
+    Height = 160
     Anchors = [akTop, akRight]
     ItemHeight = 13
     TabOrder = 4
@@ -143,8 +134,8 @@
   end
   object btnAdd: TButton
     Left = 624
-    Top = 232
-    Width = 57
+    Top = 444
+    Width = 61
     Height = 25
     Anchors = [akTop, akRight]
     Caption = 'Add'
@@ -154,84 +145,42 @@
   end
   object btnRemove: TButton
     Left = 688
-    Top = 232
-    Width = 57
+    Top = 444
+    Width = 60
     Height = 25
     Anchors = [akTop, akRight]
     Caption = 'Remove'
     TabOrder = 6
     OnClick = btnRemoveClick
   end
-  object Button1: TButton
-    Left = 624
-    Top = 304
-    Width = 121
-    Height = 25
-    Anchors = [akTop, akRight]
-    Caption = 'Copy as Spawnregion'
-    TabOrder = 7
-    Visible = False
-    OnClick = Button1Click
-  end
-  object Button2: TButton
-    Left = 624
-    Top = 336
-    Width = 121
-    Height = 25
-    Anchors = [akTop, akRight]
-    Caption = 'Copy as Region'
-    TabOrder = 8
-    Visible = False
-    OnClick = Button2Click
-  end
-  object Button3: TButton
-    Left = 624
-    Top = 368
-    Width = 121
-    Height = 25
-    Anchors = [akTop, akRight]
-    Caption = 'Paste Spawnregion'
-    TabOrder = 9
-    OnClick = Button3Click
-  end
-  object Button4: TButton
-    Left = 624
-    Top = 400
-    Width = 121
-    Height = 25
-    Anchors = [akTop, akRight]
-    Caption = 'Paste Region'
-    TabOrder = 10
-    OnClick = Button4Click
-  end
   object btnZoomOut: TButton
     Left = 624
-    Top = 452
-    Width = 41
+    Top = 488
+    Width = 30
     Height = 25
     Anchors = [akRight, akBottom]
     Caption = '-'
-    TabOrder = 11
+    TabOrder = 7
     OnClick = btnZoomOutClick
   end
   object btnZoomIn: TButton
-    Left = 672
-    Top = 452
-    Width = 41
+    Left = 656
+    Top = 488
+    Width = 29
     Height = 25
     Anchors = [akRight, akBottom]
     Caption = '+'
-    TabOrder = 12
+    TabOrder = 8
     OnClick = btnZoomInClick
   end
   object btnRedraw: TButton
-    Left = 624
-    Top = 484
-    Width = 89
+    Left = 688
+    Top = 488
+    Width = 60
     Height = 25
     Anchors = [akRight, akBottom]
     Caption = 'Redraw'
-    TabOrder = 13
+    TabOrder = 9
     OnClick = btnRedrawClick
   end
   object ToolBar1: TToolBar
@@ -240,11 +189,11 @@
     Width = 756
     Height = 22
     ButtonHeight = 19
-    ButtonWidth = 79
+    ButtonWidth = 104
     Caption = 'ToolBar1'
     List = True
     AllowTextButtons = True
-    TabOrder = 14
+    TabOrder = 10
     object ToolButton1: TToolButton
       Left = 0
       Top = 0
@@ -258,6 +207,7 @@
       Left = 75
       Top = 0
       Caption = 'Edit Region'
+      Enabled = False
       ImageIndex = 1
       Style = tbsTextButton
       OnClick = ToolButton2Click
@@ -266,22 +216,222 @@
       Left = 146
       Top = 0
       Caption = 'Export Region'
+      Enabled = False
       ImageIndex = 2
       Style = tbsTextButton
       OnClick = ToolButton3Click
     end
+    object ToolButton4: TToolButton
+      Left = 229
+      Top = 0
+      Width = 8
+      Caption = 'ToolButton4'
+      ImageIndex = 3
+      Style = tbsSeparator
+    end
+    object ToolButton5: TToolButton
+      Left = 237
+      Top = 0
+      Caption = 'Paste Spawnregion'
+      Enabled = False
+      ImageIndex = 3
+      Style = tbsTextButton
+      OnClick = ToolButton5Click
+    end
+    object ToolButton6: TToolButton
+      Left = 345
+      Top = 0
+      Caption = 'Paste Region'
+      Enabled = False
+      ImageIndex = 4
+      Style = tbsTextButton
+      OnClick = ToolButton6Click
+    end
   end
+  object Panel1: TPanel
+    Left = 0
+    Top = 23
+    Width = 756
+    Height = 17
+    Anchors = [akLeft, akTop, akRight]
+    BevelInner = bvLowered
+    Color = clSilver
+    ParentBackground = False
+    TabOrder = 11
+    DesignSize = (
+      756
+      17)
+    object Label3: TLabel
+      Left = 401
+      Top = 1
+      Width = 55
+      Height = 13
+      Anchors = [akTop, akRight]
+      Caption = 'Selected:'
+      Font.Charset = DEFAULT_CHARSET
+      Font.Color = clWindowText
+      Font.Height = -11
+      Font.Name = 'MS Sans Serif'
+      Font.Style = [fsBold]
+      ParentFont = False
+      Transparent = True
+    end
+    object Label5: TLabel
+      Left = 103
+      Top = 1
+      Width = 3
+      Height = 13
+      Transparent = True
+    end
+    object Label4: TLabel
+      Left = 2
+      Top = 1
+      Width = 97
+      Height = 13
+      Caption = 'Region/Spawn : '
+      Font.Charset = DEFAULT_CHARSET
+      Font.Color = clWindowText
+      Font.Height = -11
+      Font.Name = 'MS Sans Serif'
+      Font.Style = [fsBold]
+      ParentFont = False
+      Transparent = True
+    end
+    object lblSelected: TLabel
+      Left = 462
+      Top = 1
+      Width = 3
+      Height = 13
+      Anchors = [akTop, akRight]
+      Transparent = True
+    end
+  end
+  object DBGrid1: TDBGrid
+    Left = 624
+    Top = 58
+    Width = 124
+    Height = 179
+    Anchors = [akTop, akRight]
+    DataSource = DSRegion
+    TabOrder = 12
+    TitleFont.Charset = DEFAULT_CHARSET
+    TitleFont.Color = clWindowText
+    TitleFont.Height = -11
+    TitleFont.Name = 'MS Sans Serif'
+    TitleFont.Style = []
+    Columns = &lt;
+      item
+        Expanded = False
+        FieldName = 'Name'
+        Title.Caption = 'Region'
+        Width = 56
+        Visible = True
+      end
+      item
+        Expanded = False
+        FieldName = 'type'
+        PickList.Strings = (
+          'R'
+          'S')
+        Title.Caption = 'Type'
+        Width = 29
+        Visible = True
+      end&gt;
+  end
+  object Button1: TButton
+    Left = 624
+    Top = 238
+    Width = 124
+    Height = 25
+    Anchors = [akTop, akRight]
+    Caption = 'Remove'
+    Enabled = False
+    TabOrder = 13
+    OnClick = btnRemoveClick
+  end
+  object CDSRegion: TClientDataSet
+    Active = True
+    Aggregates = &lt;&gt;
+    Params = &lt;&gt;
+    Left = 524
+    Data = {
+      340100009619E0BD01000000180000000F000000000003000000340102496404
+      00010000000000044E616D65020049000000010005574944544802000200FF00
+      086D6964696C697374020049000000010005574944544802000200FF00077265
+      736F726573020049000000010005574944544802000200FF0007736E6F776D69
+      6E040001000000000007736E6F776D61780400010000000000077261696E6D69
+      6E0400010000000000077261696E6D617804000100000000000A67756172646F
+      776E6572020049000000010005574944544802000200FF000474797065020003
+      0000000000066163746976650200030000000000066D61786E70630400010000
+      0000000864656C61796D696E04000100000000000864656C61796D6178040001
+      0000000000086E70636379636C6504000100000000000000}
+    object CDSRegionId: TIntegerField
+      AutoGenerateValue = arAutoInc
+      FieldName = 'Id'
+    end
+    object CDSRegionName: TStringField
+      FieldName = 'Name'
+      Size = 255
+    end
+    object CDSRegionmidilist: TStringField
+      FieldName = 'midilist'
+      Size = 255
+    end
+    object CDSRegionresores: TStringField
+      FieldName = 'resores'
+      Size = 255
+    end
+    object CDSRegionsnowmin: TIntegerField
+      FieldName = 'snowmin'
+    end
+    object CDSRegionsnowmax: TIntegerField
+      FieldName = 'snowmax'
+    end
+    object CDSRegionrainmin: TIntegerField
+      FieldName = 'rainmin'
+    end
+    object CDSRegionrainmax: TIntegerField
+      FieldName = 'rainmax'
+    end
+    object CDSRegionguardowner: TStringField
+      FieldName = 'guardowner'
+      Size = 255
+    end
+    object CDSRegiontype: TBooleanField
+      FieldName = 'type'
+    end
+    object CDSRegionactive: TBooleanField
+      FieldName = 'active'
+    end
+    object CDSRegionmaxnpc: TIntegerField
+      FieldName = 'maxnpc'
+    end
+    object CDSRegiondelaymin: TIntegerField
+      FieldName = 'delaymin'
+    end
+    object CDSRegiondelaymax: TIntegerField
+      FieldName = 'delaymax'
+    end
+    object CDSRegionnpccycle: TIntegerField
+      FieldName = 'npccycle'
+    end
+  end
   object CDSNpc: TClientDataSet
     Active = True
     Aggregates = &lt;&gt;
+    IndexFieldNames = 'RegionID'
+    MasterFields = 'Id'
+    MasterSource = DSRegion
+    PacketRecords = 0
     Params = &lt;&gt;
-    Left = 568
-    Top = 4
+    Left = 488
+    Top = 60
     Data = {
-      7C0000009619E0BD0100000018000000060000000000030000007C0002496402
+      8D0000009619E0BD0100000018000000070000000000030000008D0002496402
       0049000000010005574944544802000200FF000A57616E646572547970650200
       49000000010005574944544802000200FF000278310400010000000000027931
-      0400010000000000027832040001000000000002793204000100000000000000}
+      0400010000000000027832040001000000000002793204000100000000000852
+      6567696F6E494404000100000000000000}
     object CDSNpcId: TStringField
       FieldName = 'Id'
       Size = 255
@@ -302,5 +452,58 @@
     object CDSNpcy2: TIntegerField
       FieldName = 'y2'
     end
+    object CDSNpcRegionID: TIntegerField
+      FieldName = 'RegionID'
+    end
   end
+  object CDSFlags: TClientDataSet
+    Active = True
+    Aggregates = &lt;&gt;
+    IndexFieldNames = 'RegionId'
+    MasterFields = 'Id'
+    MasterSource = DSRegion
+    PacketRecords = 0
+    Params = &lt;&gt;
+    Left = 524
+    Top = 60
+    Data = {
+      440000009619E0BD010000001800000002000000000003000000440004466C61
+      67020049000000010005574944544802000200FF0008526567696F6E49640400
+      0100000000000000}
+    object CDSFlagsFlag: TStringField
+      FieldName = 'Flag'
+      Size = 255
+    end
+    object CDSFlagsRegionId: TIntegerField
+      FieldName = 'RegionId'
+    end
+  end
+  object CDSGroup: TClientDataSet
+    Active = True
+    Aggregates = &lt;&gt;
+    IndexFieldNames = 'RegionId'
+    MasterFields = 'Id'
+    MasterSource = DSRegion
+    PacketRecords = 0
+    Params = &lt;&gt;
+    Left = 560
+    Top = 60
+    Data = {
+      450000009619E0BD01000000180000000200000000000300000045000547726F
+      7570020049000000010005574944544802000200FF0008526567696F6E496404
+      000100000000000000}
+    object CDSGroupGroup: TStringField
+      FieldName = 'Group'
+      Size = 255
+    end
+    object CDSGroupRegionId: TIntegerField
+      FieldName = 'RegionId'
+    end
+  end
+  object DSRegion: TDataSource
+    AutoEdit = False
+    DataSet = CDSRegion
+    Left = 524
+    Top = 28
+  end
 end

Modified: trunk/WPGM/src/Spawnregions.pas
===================================================================
--- trunk/WPGM/src/Spawnregions.pas	2009-03-17 19:04:31 UTC (rev 6872)
+++ trunk/WPGM/src/Spawnregions.pas	2009-03-21 04:40:17 UTC (rev 6873)
@@ -5,7 +5,7 @@
 uses
   Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
   Dialogs, StdCtrls, GR32, GR32_Blend, GR32_Image, UOMap, UOStatics, ClipBrd,
-  ComCtrls, ToolWin, DB, DBClient;
+  ComCtrls, ToolWin, DB, DBClient, ExtCtrls, Grids, DBGrids;
 
 type
   TfrmRegions = class(TForm)
@@ -20,12 +20,6 @@
     lbRects: TListBox;
     btnAdd: TButton;
     btnRemove: TButton;
-    Label3: TLabel;
-    lblSelected: TLabel;
-    Button1: TButton;
-    Button2: TButton;
-    Button3: TButton;
-    Button4: TButton;
     btnZoomOut: TButton;
     btnZoomIn: TButton;
     btnRedraw: TButton;
@@ -33,6 +27,34 @@
     ToolButton1: TToolButton;
     ToolButton2: TToolButton;
     ToolButton3: TToolButton;
+    Panel1: TPanel;
+    Label3: TLabel;
+    Label5: TLabel;
+    Label4: TLabel;
+    lblSelected: TLabel;
+    ToolButton4: TToolButton;
+    ToolButton5: TToolButton;
+    ToolButton6: TToolButton;
+    Label6: TLabel;
+    DBGrid1: TDBGrid;
+    Button1: TButton;
+    CDSRegion: TClientDataSet;
+    CDSRegionId: TIntegerField;
+    CDSRegionName: TStringField;
+    Label7: TLabel;
+    CDSRegionmidilist: TStringField;
+    CDSRegionresores: TStringField;
+    CDSRegionsnowmin: TIntegerField;
+    CDSRegionsnowmax: TIntegerField;
+    CDSRegionrainmin: TIntegerField;
+    CDSRegionrainmax: TIntegerField;
+    CDSRegionguardowner: TStringField;
+    CDSRegiontype: TBooleanField;
+    CDSRegionactive: TBooleanField;
+    CDSRegionmaxnpc: TIntegerField;
+    CDSRegiondelaymin: TIntegerField;
+    CDSRegiondelaymax: TIntegerField;
+    CDSRegionnpccycle: TIntegerField;
     CDSNpc: TClientDataSet;
     CDSNpcId: TStringField;
     CDSNpcWanderType: TStringField;
@@ -40,6 +62,14 @@
     CDSNpcy1: TIntegerField;
     CDSNpcx2: TIntegerField;
     CDSNpcy2: TIntegerField;
+    CDSNpcRegionID: TIntegerField;
+    CDSFlags: TClientDataSet;
+    CDSFlagsFlag: TStringField;
+    CDSFlagsRegionId: TIntegerField;
+    CDSGroup: TClientDataSet;
+    CDSGroupGroup: TStringField;
+    CDSGroupRegionId: TIntegerField;
+    DSRegion: TDataSource;
     procedure FormShow(Sender: TObject);
     procedure FormCreate(Sender: TObject);
     procedure pbMapPaintBuffer(Sender: TObject);
@@ -70,6 +100,9 @@
     procedure ToolButton1Click(Sender: TObject);
     procedure ToolButton3Click(Sender: TObject);
     procedure ToolButton2Click(Sender: TObject);
+    procedure ToolButton5Click(Sender: TObject);
+    procedure ToolButton6Click(Sender: TObject);
+    procedure cbMapChange(Sender: TObject);
   private
     { Private declarations }
     Places: Array of TRect;
@@ -121,7 +154,8 @@
 
 {$R *.dfm}
 
-uses Main, Math, XMLReader, StrLib, UORadarCol, RegionWizard;
+uses Main, Math, XMLReader, StrLib, UORadarCol, RegionWizard, RegionEditR,
+  RegionEditS;
 
 function TfrmRegions.MapToBuffer(Point: TPoint): TPoint;
 begin
@@ -367,16 +401,58 @@
 
 procedure TfrmRegions.ToolButton1Click(Sender: TObject);
 begin
+  if not cdsregion.Active then
+    cdsregion.Open;
+
   if not cdsnpc.Active then
     cdsnpc.Open;
-  cdsnpc.EmptyDataSet;
-  
+
+  if not cdsflags.Active then
+    cdsflags.Open;
+
+  if not cdsgroup.Active then
+    cdsgroup.Open;
+
   frmRegionW1.Show;
 end;
 
 procedure TfrmRegions.ToolButton2Click(Sender: TObject);
+var
+  i,u: integer;
 begin
-  Application.MessageBox('Not yet implemented', 'Error', MB_OK+MB_ICONERROR);
+  if regiontype then
+  begin
+    frmregionedit.ERegionName.Text := regionname;
+    frmregionedit.Eguardowner.Text  := guardowner;
+    frmregionedit.Emidilist.Text := midlist;
+    frmregionedit.Erainchancemin.Text  := inttostr(rainchancemin);
+    frmregionedit.Erainchancemax.Text  := inttostr(rainchancemax);
+    frmregionedit.ESnowChancemin.Text  := inttostr(snowchancemin);
+    frmregionedit.ESnowChancemax.Text  := inttostr(snowchancemax);
+    frmregionedit.LBSelected.Items.AddStrings(flags);
+    for I := 0 to frmregionedit.LBSelected.Items.Count - 1 do
+    begin
+      u := frmregionedit.LBAvaible.Items.IndexOfName(frmregionedit.LBSelected.Items.Strings[i]);
+      if u &lt;&gt; -1 then      
+        frmregionedit.LBAvaible.Items.Delete(u);
+    end;
+
+    frmregionedit.EResores.Text := resores;
+    frmregionedit.ShowModal;
+  end
+  else
+  begin
+    //frmregioneditS.ShowModal;
+    FrmRegionEditS.ERegionName.Text := RegionName;
+    FrmRegionEditS.EMaxnpcamount.Text := inttostr(Maxnpcamount);
+    FrmRegionEditS.Edelaymin.Text := inttostr(delaymin);
+    FrmRegionEditS.Edelaymax.Text := inttostr(delaymax);
+    FrmRegionEditS.Enpcspercycle.Text := inttostr(npcspercycle);
+    FrmRegionEditS.CheckBox1.Checked := active;
+    // group
+    FrmRegionEditS.ListBox1.Items.AddStrings(group);
+    FrmRegionEditS.showmodal;
+  end;
 end;
 
 procedure TfrmRegions.ToolButton3Click(Sender: TObject);
@@ -524,6 +600,121 @@
 
 end;
 
+procedure TfrmRegions.ToolButton5Click(Sender: TObject);
+var
+  ClipBoard: TClipboard;
+  Content: String;
+  Reader: TXMLReader;
+  Document, Node: TXMLNode;
+  i: Integer;
+  sFrom, sTo: String;
+  Parts: TStringList;
+  x1, x2, y1, y2: Integer;
+begin
+  ClipBoard := TClipBoard.Create;
+  Content := '&lt;rectangles&gt;' + ClipBoard.AsText + '&lt;/rectangles&gt;';
+
+  Reader := nil;
+  Document := nil;
+  Parts := TStringList.Create;
+
+  try
+    Reader := TXMLStringReader.Create(Content);
+    Document := Reader.ParseDocument.Nodes[0];
+
+    // Iterate over the rectangle nodes
+    for i := 0 to Document.NodeCount - 1 do begin
+      Node := Document.Nodes[i];
+
+      if Node.Name &lt;&gt; 'rectangle' then
+        continue; // Skip this node
+
+      // Look up From + To
+      Node.LookupBasicData('from', sFrom);
+      Node.LookupBasicData('to', sTo);
+
+      Parts.Clear;
+      Split(sFrom, ',', Parts);
+      if Parts.Count &lt;&gt; 2 then
+        continue; // From attribute is incorrect
+
+      x1 := StrToIntDef(Parts[0], 0);
+      y1 := StrToIntDef(Parts[1], 0);
+
+      Parts.Clear;
+      Split(sTo, ',', Parts);
+      if Parts.Count &lt;&gt; 2 then
+        continue; // To attribute is incorrect
+
+      x2 := StrToIntDef(Parts[0], 0);
+      y2 := StrToIntDef(Parts[1], 0);
+
+      AddRect(x1, y1, x2, y2);
+    end;
+  except
+    on e: Exception do begin
+      Application.MessageBox(PAnsiChar('The following error occured while parsing the XML definition: ' + #13 + e.Message), 'Error', MB_OK+MB_ICONERROR);
+    end;
+  end;
+
+  Reader.Free;
+  Document.Free;
+  Parts.Free;
+  ClipBoard.Free;
+end;
+
+procedure TfrmRegions.ToolButton6Click(Sender: TObject);
+var
+  ClipBoard: TClipboard;
+  Content: String;
+  Reader: TXMLReader;
+  Document, Node: TXMLNode;
+  i: Integer;
+  Temp: String;
+  x1, x2, y1, y2: Integer;
+begin
+  ClipBoard := TClipBoard.Create;
+  Content := '&lt;rectangles&gt;' + ClipBoard.AsText + '&lt;/rectangles&gt;';
+
+  Reader := nil;
+  Document := nil;
+
+  try
+    Reader := TXMLStringReader.Create(Content);
+    Document := Reader.ParseDocument.Nodes[0];
+
+    // Iterate over the rectangle nodes
+    for i := 0 to Document.NodeCount - 1 do begin
+      Node := Document.Nodes[i];
+
+      if Node.Name &lt;&gt; 'rectangle' then
+        continue; // Skip this node
+
+      Node.LookupBasicData('x1', temp);
+      x1 := StrToIntDef(temp, 0);
+
+      Node.LookupBasicData('x2', temp);
+      x2 := StrToIntDef(temp, 0);
+
+      Node.LookupBasicData('y1', temp);
+      y1 := StrToIntDef(temp, 0);
+
+      Node.LookupBasicData('y2', temp);
+      y2 := StrToIntDef(temp, 0);
+
+      AddRect(x1, y1, x2, y2);
+    end;
+  except
+    on e: Exception do begin
+      Application.MessageBox(PAnsiChar('The following error occured while parsing the XML definition: ' + #13 + e.Message), 'Error', MB_OK+MB_ICONERROR);
+    end;
+  end;
+
+  Reader.Free;
+  Document.Free;
+  ClipBoard.Free;
+end;
+
 procedure TfrmRegions.FormDestroy(Sender: TObject);
 begin
   Buffer.Free;
@@ -563,7 +754,7 @@
   i: Integer;
 begin
   if lbRects.ItemIndex &lt;&gt; -1 then begin
-    if lbRects.ItemIndex &lt; Length(Places) - 1 then begin
+    if lbRects.ItemIndex &lt;= Length(Places) - 1 then begin
       // Copy Downwards
       for i := lbRects.ItemIndex to Length(Places) - 2 do begin
         Places[i] := Places[i+1];
@@ -795,6 +986,14 @@
   ClipBoard.Free;
 end;
 
+procedure TfrmRegions.cbMapChange(Sender: TObject);
+begin
+  if cbmap.ItemIndex &lt;&gt; -1 then
+    ChangeMap(cbmap.ItemIndex);
+
+
+end;
+
 procedure TfrmRegions.lbRectsKeyDown(Sender: TObject; var Key: Word;
   Shift: TShiftState);
 begin


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000075.html">[Wolfpack-svn] r6872 - in trunk/server: build release/definitions
</A></li>
	<LI>Next message: <A HREF="000077.html">[Wolfpack-svn] r6874 - in trunk/server/src: . ai
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#76">[ date ]</a>
              <a href="thread.html#76">[ thread ]</a>
              <a href="subject.html#76">[ subject ]</a>
              <a href="author.html#76">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/wolfpack-svn">More information about the Wolfpack-svn
mailing list</a><br>
</body></html>
